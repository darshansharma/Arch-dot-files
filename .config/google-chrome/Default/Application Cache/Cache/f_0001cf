ww.prototype.X7=ZO(58,function(){return mv(this,3)});ED.prototype.X7=ZO(57,function(){return mv(this,5)});ww.prototype.y5=ZO(56,function(){return V(this,3)});ED.prototype.y5=ZO(55,function(){return V(this,5)});ww.prototype.Z7=ZO(54,function(){return mv(this,2)});ED.prototype.Z7=ZO(53,function(){return mv(this,4)});ww.prototype.L5=ZO(52,function(){return V(this,2)});ED.prototype.L5=ZO(51,function(){return V(this,4)});function nNd(a,b){Wf(a,11).push(b)}
function oNd(a,b,c){return"r"==c?Rlb(a,b):Slb(a,b)}function pNd(a,b){return(a=UR(a,b))?a.rect:null}function qNd(a,b){a.D=b}function rNd(a,b,c){c=void 0===c?!0:c;yq.call(this,"docs-material-dialog",a,b);Oq(this,null);Nq(this,!0);Jq(this,this.GJ?0:.6);this.O=new ZR("OK");this.Ya(this.O);(this.C=c?new YR("Cancel"):null)&&this.Ya(this.C)}q(rNd,yq);p=rNd.prototype;
p.Za=function(){var a=this;yq.prototype.Za.call(this);this.getHandler().R(this.O,"action",function(){return a.u7()}).R(this.qb(),"keypress",this.wIb);this.C&&this.getHandler().R(this.C,"action",function(){a.dispatchEvent("Ac")&&a.setVisible(!1)})};p.wIb=function(a){13==a.keyCode&&(a.target==gDa(this)||this.C&&a.target==this.C.getElement()?this.dispatchEvent("Ac")&&this.setVisible(!1):("TEXTAREA"!=a.target.tagName&&"SELECT"!=a.target.tagName&&"A"!=a.target.tagName||a.target.disabled)&&this.u7())};
p.u7=function(){this.dispatchEvent("zc")&&this.setVisible(!1)};p.Ma=function(){yq.prototype.Ma.call(this);var a=Dq(this);this.C&&this.C.render(a);this.O.render(a);L(a,!0);hr(gDa(this),cAc)};p.cz=function(a){yq.prototype.cz.call(this,a);Jq(this,this.GJ?0:.6)};function sNd(a){Tf(this,a,0,-1,null,null)}x(sNd,Sf);function tNd(a){Tf(this,a,0,-1,null,null)}x(tNd,Sf);var uNd=/['()]/g;function vNd(a){return"%"+a.charCodeAt(0).toString(16)}
function wNd(a){a=Ob(String(a));uNd.lastIndex=0;return uNd.test(a)?a.replace(uNd,vNd):a}function xNd(a){return a.ll()+Zb(a.C)}
function yNd(a){var b=P;var c=qr(""+O(a.K1b));c='<div class="docs-unsupportedofficefeatureswarning-content-header"><div class="docs-unsupportedofficefeatureswarning-content-header-warningtext">'+O(c)+'</div><div class="docs-unsupportedofficefeatureswarning-content-header-restorefiletext">';c=P(c+"The original file can be restored from version history</div></div>");var d='<div class="docs-unsupportedofficefeatureswarning-content-features-list">';a=a.jd;for(var e=a.length,f=0;f<e;f++)d+=P('<div class="docs-unsupportedofficefeatureswarning-content-feature">'+
O(pr(""+a[f]))+"</div>");d=P(d+"</div>");return b(c+d)};function H2(a,b,c,d){At.call(this,"docs-unsupportedofficefeatureswarning",void 0,d);this.Aa=b;this.Ra=c;this.J=new ZR(this.iCa());this.Ya(this.J);this.C=null;this.V7()&&(this.C=new ZR(this.vCa()),this.Ya(this.C));this.F=null;a.F&&I(H(),"docs-esdttfl")&&(this.F=new ZP("warning-dialogs",!1,d),this.Ya(this.F));Oq(this,null);Nq(this,!1);this.cz(!1);this.Ci=!0}x(H2,At);p=H2.prototype;p.Tja=n("alertdialog");
p.Ma=function(){H2.oa.Ma.call(this);hr(this.Ob(),yNd,{jd:this.Aa,K1b:this.Ra},void 0);var a=Dq(this);this.F&&this.F.render(a);this.J.render(a);this.V7()&&this.C.render(a);L(a,!0);L(Cq(this),!1);br(this,null);Kh(this.qb(),this.tza())};p.Za=function(){var a=this;H2.oa.Za.call(this);this.getHandler().R(this.J,"action",function(){return a.Oka()});this.V7()&&this.getHandler().R(this.C,"action",function(){a.setVisible(!1)})};p.Oka=function(){this.setVisible(!1)};p.V7=Ne;p.vCa=sa;function zNd(a,b,c,d,e,f){H2.call(this,a,b,c,d);this.L=!1;this.ma=e;this.O=f}x(zNd,H2);p=zNd.prototype;p.tza=n("docs-editconsentdialog");p.iCa=n("Continue editing");p.V7=Oe;p.vCa=n("Cancel");p.Oka=function(){zNd.oa.Oka.call(this);this.L=!0;this.ma.dc()};p.Xl=function(){zNd.oa.Xl.call(this);this.L||this.O.dc()};function ANd(a,b,c,d){H2.call(this,a,b,c,d)}x(ANd,H2);ANd.prototype.tza=n("docs-unsupportedfeatureslistdialog");ANd.prototype.iCa=n("OK");function BNd(a){return P('<input type="text" id="docs-copy-link" class="'+Q("docs-copy-link")+'" value="'+Q(a.link)+'" readonly="readonly">')};function I2(a,b,c,d){At.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.Ra="";this.F=b||null;this.Aa=c||new Qxb(a);this.ma=null!=d?d:null;a=new Lq;Qq(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.Aa.C()&&Qq(a,{key:"copy-link",caption:"Copy link"});Oq(this,a)}x(I2,At);p=I2.prototype;
p.Ma=function(){I2.oa.Ma.call(this);Kh(Iq(this),"copy-link-dialog");Kh(Pq(this.D,"done"),"copy-link-done-button");this.C=N(BNd,{link:this.Ra},void 0,this.qa());Dh(this.C,"label","Link to this comment");this.Ob().appendChild(this.C);if(this.L=Pq(this.D,"copy-link")){var a=be("DIV");Kh(a,"copy-link-butter-holder");this.getElement().insertBefore(a,Cq(this));this.O=new Ap(a);this.J=Cp("Link copied to clipboard.","info",!1,4E3)}null!==this.ma&&($h(this.Rq(),"z-index",this.ma),$h(Iq(this),"z-index",this.ma+
1))};p.Al=function(){I2.oa.Al.call(this);this.F&&this.getHandler().R(this.F,"copy",this.bAa);this.C.focus();this.C.select()};p.Xl=function(){I2.oa.Xl.call(this);this.F&&this.getHandler().Kc(this.F,"copy",this.bAa)};p.Za=function(){I2.oa.Za.call(this);this.getHandler().R(this.C,"click",this.ZRb);this.L&&this.getHandler().R(this.L,"click",this.Dmb)};p.GSb=function(a){this.Ra=a;this.C&&(this.C.value=a)};p.ZRb=function(a){a.target.focus();a.target.select()};
p.Dmb=function(a){a.stopPropagation();this.F&&this.Aa.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.C(this.C.value))};p.bAa=function(a){a.C&&this.J&&this.O&&(this.J.isVisible()||this.O.postMessage(this.J),this.C.focus(),this.C.select())};p.Xa=function(){I2.oa.Xa.call(this);C(this.J);delete this.J;delete this.L;delete this.C};function CNd(a,b,c){return ADa(a||"There was a problem",rd(b),void 0,void 0,void 0,void 0,c)};function DNd(a){return P("<div><div>"+O(a.x4a)+"</div>"+O(Et({id:"waffle-confirm-suppress-checkbox",Hd:"waffle-confirm-suppress-checkbox"},void 0))+'<span id="waffle-confirm-suppress-label">'+O(a.pra)+"</span></div>")};function ENd(a,b,c,d,e,f,h){if(ya(c)){var k=new Lq;k.set("ok",c.ok,!0);k.set("cancel",c.cancel,!1,!0)}else k=lDa;return FNd(d||"Heads up!",a,b,k,e,f,h)}function FNd(a,b,c,d,e,f,h){b=rd(b);if(f){b=fr(DNd({x4a:b,pra:f}));var k=new Ft;var l=c;c=function(){l(k.isChecked())}}a=BDa(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Ya(k),k.yb(Ee(a.qa(),"waffle-confirm-suppress-checkbox")),c=Ee(a.qa(),"waffle-confirm-suppress-label"),Dt(k,c),k.zc(!1));return a};function GNd(a){var b=a.description;a=a.iQb;return P('<div class="waffle-dv-rec-chip" title="'+Q(b)+'"><div class="waffle-dv-rec-range">'+O(a)+'</div><div class="waffle-dv-rec-description">'+O(b)+"</div></div>")}function HNd(){return P('<div class="waffle-dv-no-suggestions" role="alert" aria-live="polite">No suggestions for selected data</div>')};function J2(){var a=new qM(null);bP(a,!0);return a};function INd(a,b,c){E.call(this);this.D=a;this.Ch=b;this.Wb=c;this.V=this.H=this.Wa=this.Ra=this.$=this.F=null;this.mc=new LP;this.xa(this.mc);this.Be=new LP;this.xa(this.Be);this.Aa=this.O=null;this.Cd=new LP;this.xa(this.Cd);this.Pe=new LP;this.xa(this.Pe);this.rb=this.jb=this.ib=this.ma=this.L=null;this.Kd=new LP;this.xa(this.Kd);this.ke=new LP;this.xa(this.ke);this.fd=new LP;this.xa(this.fd);this.Fe=new LP;this.xa(this.Fe);this.ub=this.Yc=null;this.C=new KT("");this.xa(this.C);this.zb=this.J=
this.Kb=this.Jb=this.Se=this.Gc=this.Qb=this.Gb=null;this.yg=this.yd=!1;this.Nb=this.Df=this.sb=this.Cb=null;this.jf=new Rh(this);this.xa(this.jf);this.Rc=new xv;this.hg=this.eh=this.Gg=this.Qf=this.Qg=this.bb=null;this.zx();a=this.jf;a.R(this.F,"action",this.isb);a.R(this.$,"action",this.yla);a.R(this.Ra,"action",this.yla);a.R(this.Wa,"action",this.yla);a.R(this.J,"focus",Ca(this.FQa,!0));a.R(this.J,"blur",Ca(this.FQa,!1));a.R(this.J,"change",this.mla);a.R(this.J,"keyup",this.mla);b=[this.O,this.Aa,
this.H,this.V,this.L,this.ma,this.jb,this.rb];for(c=0;c<b.length;c++)this.jf.R(b[c],"change",v(this.vYb,this,b[c])),this.jf.R(b[c],"keyup",v(this.asb,this,b[c]));a.R(this.sb,"change",v(this.qIa,this));a.R(this.ib,"change",v(this.bEb,this));a.vg(this.zb,mf,this.pzb)}x(INd,E);var JNd="placeholder"in document.createElement("input"),KNd=/\s*,\s*/;
function LNd(a){var b=a.hg;b||(b=[{Wi:"List from a range",type:4},{Wi:"List of items",type:3},{Wi:"Number",type:0},{Wi:"Text",type:1},{Wi:"Date",type:2},{Wi:"Custom formula is",type:5}],I(H(),"fecdv")&&b.push({Wi:"Tick box",type:6}),a.hg=b);return b}
function MNd(a){var b=a.eh;b||(b=[{Wi:"contains",code:9,inputs:0,example:"Approved"},{Wi:"does not contain",code:10,inputs:0,example:"Approved"},{Wi:"equals",code:13,inputs:0,example:"Approved"},{Wi:"is a valid email",code:14,inputs:-1,example:null},{Wi:"is a valid URL",code:15,inputs:-1,example:null}],a.eh=b);return b}
function NNd(a){var b=a.Qf;b||(b=[{Wi:"is a valid date",code:30,inputs:-1,example:null},{Wi:"equal to",code:16,inputs:2,example:"15/11/2014"},{Wi:"before",code:17,inputs:2,example:"15/11/2014"},{Wi:"on or before",code:19,inputs:2,example:"15/11/2014"},{Wi:"after",code:18,inputs:2,example:"15/11/2014"},{Wi:"on or after",code:20,inputs:2,example:"15/11/2014"},{Wi:"between",code:21,inputs:3,example:"15/11/2014",yP:"15/11/2015"},{Wi:"not between",code:22,inputs:3,example:"15/11/2014",yP:"15/11/2015"}],
a.Qf=b);return b}function ONd(a){var b=a.Gg;b||(b=[{Wi:"range",code:23,inputs:6,example:null},{Wi:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.Gg=b);return b}
function PNd(a){var b=a.Qg;b||(b=[{Wi:"between",code:7,inputs:8,example:"10",yP:"100"},{Wi:"not between",code:8,inputs:8,example:"10",yP:"100"},{Wi:"less than",code:3,inputs:7,example:"10"},{Wi:"less than or equal to",code:4,inputs:7,example:"10"},{Wi:"greater than",code:1,inputs:7,example:"10"},{Wi:"greater than or equal to",code:2,inputs:7,example:"10"},{Wi:"equal to",code:5,inputs:7,example:"10"},{Wi:"not equal to",code:6,inputs:7,example:"10"}],a.Qg=b);return b}
function QNd(){return{Wi:"",code:29,inputs:0,example:"=ISODD(A1)"}}function RNd(){return{Wi:"",code:31,inputs:-1,example:""}}p=INd.prototype;
p.zx=function(){var a=this.D,b,c,d,e,f,h,k,l,m,r,u,w,y,B,J=a.qa(),R;var U=J.Ma("TR","waffle-dv-trrules",J.Ma("TD","waffle-dv-label",J.Ma("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),J.Ma("TD",{colspan:"7"},l=J.Ma("DIV","goog-inline-block"),R=J.Ma("DIV","goog-inline-block"),h=J.Ma("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=J.Ma("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=J.Ma("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=J.Ma("SPAN","waffle-dv-separator","and"),k=J.Ma("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=J.Ma("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=J.Ma("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.fd.yb(h);this.Fe.yb(k);this.Cd.yb(c);this.Pe.yb(d);this.mc.yb(e);this.Be.yb(f);var Y=J2();Ii(Y,l);var ka=J2();Ii(ka,l);var pa=J2();Ii(pa,l);var za=J2();Ii(za,l);var Da=SNd(a,R);(w=Y.getElement())&&Dh(w,"labelledby","waffle-dv-criteria");
var La;var Ja=J.Ma("TR","waffle-dv-trrules waffle-dv-trrules-showitems",J.Ma("TD"),J.Ma("TD",{colspan:"7"},La=J.Ma("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show drop-down list in cell")));w=new Ft;Dt(w,La);Ii(w,La);var Za=J.Ma("TR","waffle-dv-trrules waffle-dv-trrules-showitems",J.Ma("TD"),J.Ma("TD",{colspan:"7"},m=J.Ma("SPAN","waffle-dv-label waffle-dv-checkbox-label","Use custom cell values")));var Ab=new Ft;Dt(Ab,m);Ii(Ab,m);var pb=J.Ma("TR","waffle-dv-trrules",J.Ma("TD"),J.Ma("TD","waffle-dv-customcheckboxlabel",
J.Ma("SPAN",{id:"customCheckboxInputLabel_checked"},"Ticked:")),J.Ma("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},r=J.Ma("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));var Wa=J.Ma("TR","waffle-dv-trrules",J.Ma("TD"),J.Ma("TD","waffle-dv-customcheckboxlabel",J.Ma("SPAN",{id:"customCheckboxInputLabel_unchecked"},"Unticked:")),J.Ma("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},u=J.Ma("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));this.Kd.yb(r);
this.ke.yb(u);Dh(r,"labelledby","customCheckboxInputLabel_checked");Dh(u,"labelledby","customCheckboxInputLabel_unchecked");OP(this.Kd,"e.g. TRUE");OP(this.ke,"e.g. FALSE");var Zc=J.Ma("TR","waffle-dv-trrules",J.Ma("TD","waffle-dv-label",J.Ma("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),J.Ma("TD",{colspan:"7"},J.Ma("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},J.Ma("INPUT",{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",
role:"radio"}),J.Ma("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),J.Ma("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),J.Ma("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new NKc(!0);OKc(m,"onInvalidData",Zc);var hc=J.Ma("TR","waffle-dv-trrules waffle-dv-trrules-appearance",J.Ma("TD",null,J.Ma("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),J.Ma("TD",{colspan:"7"},y=J.Ma("SPAN","waffle-dv-label waffle-dv-checkbox-label",
"Show validation help text:")));var Nc=new Ft;Dt(Nc,y);Ii(Nc,y);y=Nc.qb();var bd=Oia(y,"labelledby");Dh(y,"labelledby","waffle-dv-appearance "+bd);y=J.Ma("TR","waffle-dv-trrules",J.Ma("TD"),J.Ma("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},B=J.Ma("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),bd=J.Ma("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));ye(bd,!0);a=a.Ra.childNodes[0];J.appendChild(a,U);J.appendChild(a,
Ja);J.appendChild(a,Za);J.appendChild(a,pb);J.appendChild(a,Wa);J.appendChild(a,Zc);J.appendChild(a,hc);J.appendChild(a,y);this.C.render(l);J=this.C;J.Tna=29;J.resize();J=this.C;J.NLa=200;J.resize();this.C.getElement().style.width="324px";JNd?this.C.getElement().placeholder="Enter items separated by a comma...":(J=this.C.getElement(),pj(J,"Enter items separated by a comma...","Enter items separated by a comma..."));if(J=this.C.getElement())Hh(J,"Enter items separated by a comma..."),Lh(J,["waffle-dv-list-options-textarea",
"jfk-textinput"]);this.J=B;Y.setVisible(!0);J=LNd(this);TNd(this,J,Y);J=PNd(this);TNd(this,J,za);J=MNd(this);TNd(this,J,ka);J=NNd(this);TNd(this,J,pa);UNd(this,Y,za,ka,pa,h,k,c,d,e,f,b,l,Da,Ja,y,w,La,bd,Nc,R,m,Ab,r,u,Za,pb,Wa)};
function UNd(a,b,c,d,e,f,h,k,l,m,r,u,w,y,B,J,R,U,Y,ka,pa,za,Da,La,Ja,Za,Ab,pb){a.F=b;a.F.setVisible(!0);a.Ra=c;a.$=e;a.Wa=d;a.Yc=u;a.L=f;a.ma=h;a.O=k;a.Aa=l;a.H=m;a.V=r;a.ub=w;a.bb=y;a.Gb=pa;a.ib=Da;a.jb=La;a.rb=Ja;a.Se=Za;a.Jb=Ab;a.Kb=pb;L(a.Se,!1);L(a.Jb,!1);L(a.Kb,!1);ka.zc(!1);a.sb=ka;a.Nb=za;VNd(a,!1);a.Qb=B;R.zc(!0);a.Cb=R;a.Df=U;a.Gc=J;L(a.Gc,!0);WNd(a);XNd(a);a.zb=Y;L(a.zb,!1)}
function YNd(a,b){L(a.Qb,23==b||24==b);a.Df.innerText="Show drop-down list in cell";b=31==b;L(a.Se,b);var c=a.ib.isChecked();L(a.Jb,b&&c);L(a.Kb,b&&c)}function ZNd(a){UNd(a,a.F,a.Ra,a.Wa,a.$,a.L,a.ma,a.O,a.Aa,a.H,a.V,a.Yc,a.ub,a.bb,a.Qb,a.Gc,a.Cb,a.Df,a.zb,a.sb,a.Gb,a.Nb,a.ib,a.jb,a.rb,a.Se,a.Jb,a.Kb)}function TNd(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.qa();e=new Kk(b[d].Wi,null,e);c.Ad(e);Ch(e.getElement(),"menuitem")}c.Ve(0)}p.yla=function(){XNd(this);this.J.value=$Nd(this);this.dispatchEvent("change")};
p.isb=function(){WNd(this);XNd(this);this.J.value=$Nd(this);this.dispatchEvent("change")};p.FQa=ca("yg");p.mla=function(a){this.yd||a&&!gla(a)||this.J.value===aOd(this)||(this.yd=!0,L(this.zb,!0))};p.pzb=function(){this.yd=!1;this.J.value=$Nd(this);L(this.zb,!1)};p.qIa=function(){L(this.Gc,this.sb.isChecked())};p.bEb=function(){var a=this.ib.isChecked();a||bOd(this);L(this.Jb,a);L(this.Kb,a);cOd(this)};function cOd(a){a.J.value=$Nd(a)}function dOd(a){cOd(a);a.C.resize()}
p.vYb=function(a){cOd(this);eOd(this,a)?(this.D.cl=0,K2(a),this.dispatchEvent("change")):(this.D.cl=1,L2(a),this.dispatchEvent("error"))};p.asb=function(){this.dispatchEvent("keyup")};function eOd(a,b){if(0!=M2(a))return!0;var c=b.value;if(null!=c&&yi(b)){if(!N2(a.D))return!0;a=O2(a,c,fOd(a).code);return null!=a&&(mv(a,3)||mv(a,5)&&a.uo().zd()&&3==V(a.uo().eb(),1))}return!0}function L2(a){a.select();Kh(a,"waffle-input-error")}function K2(a){a&&Mh(a,"waffle-input-error")}
function bOd(a){K2(a.C.getElement());K2(a.H);K2(a.V);K2(a.L);K2(a.ma);K2(a.jb);K2(a.O);K2(a.Aa);K2(a.bb.rr());a.D.cl=0;a.dispatchEvent("change")}function M2(a){return LNd(a)[a.F.Jg()].type}function WNd(a){var b=M2(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.$.setVisible(c);a.Ra.setVisible(d);a.Wa.setVisible(e);L(a.ub,f);L(a.Gb,h);L(a.L,!1);L(a.ma,!1);L(a.O,!1);L(a.Aa,!1);L(a.H,!1);L(a.V,!1);f&&a.C.resize();a.dispatchEvent("change")}
function fOd(a){var b;null!=gOd(a)?b=gOd(a):a.$.isVisible()?b=NNd(a)[a.$.Jg()]:a.Ra.isVisible()?b=PNd(a)[a.Ra.Jg()]:5==M2(a)?b=QNd():6==M2(a)?b=RNd():b=MNd(a)[a.Wa.Jg()];return b}function gOd(a){var b=ONd(a);return 4==M2(a)?b[0]:3==M2(a)?b[1]:null}
function XNd(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,r=fOd(a);-1!=r.inputs&&(0==r.inputs?d=!0:1==r.inputs?k=e=d=!0:2==r.inputs?f=!0:3==r.inputs?k=h=f=!0:7==r.inputs?b=!0:8==r.inputs?k=c=b=!0:5==r.inputs?l=!0:6==r.inputs&&(m=!0));var u=fOd(a);if(3==M2(a))JNd?a.C.getElement().placeholder="Enter items separated by a comma...":(u=a.C.getElement(),pj(u,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(u.example)if(0==u.inputs||1==u.inputs)OP(a.Cd,"e.g. "+
u.example),OP(a.Pe,"e.g. "+u.yP||"");else if(2==u.inputs||3==u.inputs)OP(a.mc,"e.g. "+u.example),OP(a.Be,"e.g. "+u.yP||"");else if(7==u.inputs||8==u.inputs)OP(a.fd,"e.g. "+u.example),OP(a.Fe,"e.g. "+u.yP||"");bOd(a);L(a.L,b);L(a.ma,c);L(a.O,d);L(a.Aa,e);L(a.H,f);L(a.V,h);L(a.ub,l);l&&a.C.resize();L(a.Gb,m);YNd(a,r.code);L(a.Yc,k)}
function O2(a,b,c){var d=N2(a.D);if(""==b||null==d.C)return null;var e=d.rect,f=e.yc();e=e.xc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.C+"",f,e,b,c,!0))?a.Rc.kd(Uv.Ba(),b):null}
function hOd(a){var b=new Zv,c=fOd(a),d=c.code,e=[];switch(c.inputs){case 0:e.push(O2(a,a.O.value,d));break;case 1:e.push(O2(a,a.O.value,d));e.push(O2(a,a.Aa.value,d));break;case 2:e.push(O2(a,a.H.value,d));break;case 3:e.push(O2(a,a.H.value,d));e.push(O2(a,a.V.value,d));break;case 7:e.push(O2(a,a.L.value,d));break;case 8:e.push(O2(a,a.L.value,d));e.push(O2(a,a.ma.value,d));break;case 5:a=a.C.eb().split(",");for(c=0;c<a.length;c++)e.push(HBc(a[c]));break;case 6:c=Meb("="+a.bb.eb());e.push(O2(a,c,
d));break;case -1:a.ib.isChecked()&&(e.push(O2(a,Nb(a.jb.value),d)),Kb(a.rb.value)||e.push(O2(a,Nb(a.rb.value),d)))}for(a=0;a<e.length;a++)if(!e[a])return null;d=vS(d,e);W(b,1,d);return b}function iOd(a){var b=Nb(a.bb.eb());!a.Wb.D.D[Nb(Zb(b).toLowerCase())]&&TR(a.Wb,b)&&(b=Tzc(a.Wb,b,!0));return b}function $Nd(a){return a.yd||a.yg?a.J.value:aOd(a)}
function aOd(a){var b="";var c=M2(a);var d=4==c;c=3==c||4==c;if(a.$.isVisible())c=NNd(a)[a.$.Jg()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date ";else if(a.Wa.isVisible())c=MNd(a)[a.Wa.Jg()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid URL":b+"Enter text that ";else if(c)c=gOd(a),b+="Click and enter a value from ";else if(5==M2(a))c=QNd(),b="Enter a value that satisfies the formula:";else if(6==M2(a))if(c=RNd(),a.ib.isChecked()&&!Kb(Nb(a.jb.value))){b=Nb(a.jb.value);var e=
Nb(a.rb.value);b=Kb(e)?"Enter "+(b+" or blank."):"Enter "+(b+(" or "+(e+".")))}else b="Enter TRUE or FALSE.";else c=PNd(a)[a.Ra.Jg()],b+="Enter a number ";-1!=c.inputs&&(b+=c.Wi);e=iOd(a);23==c.code&&""!=e&&d&&(d=Tzc(a.Wb,e,!0))&&(b+=" "+d);Kb(Zb(a.O.value))||0!=c.inputs&&1!=c.inputs?Kb(Zb(a.H.value))||2!=c.inputs&&3!=c.inputs?Kb(Zb(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.H.value:b+=" "+a.O.value;Kb(Zb(a.Aa.value))||1!=c.inputs?Kb(Zb(a.V.value))||3!=c.inputs?Kb(Zb(a.ma.value))||
8!=c.inputs||(b+=" and "+a.ma.value):b+=" and "+a.V.value:b+=" and "+a.Aa.value;return b}function VNd(a,b){PKc(a.Nb,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function P2(a,b){switch(b){case 0:a.F.Ve(2);break;case 1:a.F.Ve(3);break;case 2:a.F.Ve(4);break;case 3:a.F.Ve(1);break;case 4:a.F.Ve(0);break;case 5:a.F.Ve(5);break;case 6:a.F.Ve(6)}}
function jOd(a,b,c,d,e){a.F.Ve(0);a.$.Ve(0);a.Ra.Ve(0);a.Wa.Ve(0);a.J.value="";a.L.value="";a.ma.value="";a.H.value="";a.V.value="";a.O.value="";a.Aa.value="";a.C.ob("");a.bb.ob("");VNd(a,!1);var f=a.yd=!1,h=!1,k=!1,l=!1,m=!1,r=!1,u=!1,w=!1,y=!1,B=!1,J=!1,R=!1,U=!1,Y=!1,ka=!1,pa=!1,za=!1,Da=!1,La=b&&$v(b);b=La&&Wv(La);if((La=La&&Xv(La))&&b){for(var Ja=ONd(a),Za=NNd(a),Ab=PNd(a),pb=MNd(a),Wa=QNd(),Zc=RNd(),hc=0,Nc=0;Nc<Ja.length;Nc++)if(b==Ja[Nc].code){hc=Ja[Nc].inputs;23==Ja[Nc].code?(pa=!0,P2(a,
4)):(R=!0,P2(a,3));a.Cb.zc(!!e);break}for(e=0;e<Za.length;e++)if(b==Za[e].code){hc=Za[e].inputs;a.$.Ve(e);P2(a,2);U=w=!0;break}for(e=0;e<Ab.length;e++)if(b==Ab[e].code){hc=Ab[e].inputs;a.Ra.Ve(e);P2(a,0);Y=y=!0;break}for(e=0;e<pb.length;e++)if(b==pb[e].code){hc=pb[e].inputs;a.Wa.Ve(e);P2(a,1);ka=B=!0;break}b==Wa.code&&(hc=Wa.inputs,P2(a,5),za=!0);b==Zc.code&&(hc=Zc.inputs,P2(a,6),Da=!0);if(U||ka||Y||R||pa||za||Da)if(ka=N2(a.D),U=ka.rect.yc(),Y=ka.rect.xc(),ka=ka.C+"",-1==hc)Da&&0<La.length&&(J=!0,
a.ib.zc(!0),a.Kd.ob(nF(La[0],ka,U,Y)),1<La.length&&a.ke.ob(nF(La[1],ka,U,Y)));else if(0==hc)m=nF(La[0],ka,U,Y),a.Cd.ob(m),m=!0;else if(1==hc)r=nF(La[0],ka,U,Y),m=nF(La[1],ka,U,Y),a.Cd.ob(r),a.Pe.ob(m),r=m=u=!0;else if(2==hc)f=nF(La[0],ka,U,Y),a.mc.ob(f),f=!0;else if(3==hc)h=nF(La[0],ka,U,Y),f=nF(La[1],ka,U,Y),a.mc.ob(h),a.Be.ob(f),h=f=u=!0;else if(7==hc)k=nF(La[0],ka,U,Y),a.fd.ob(k),k=!0;else if(8==hc)l=nF(La[0],ka,U,Y),k=nF(La[1],ka,U,Y),a.fd.ob(l),a.Fe.ob(k),l=k=u=!0;else if(5==hc){R=!0;Da=[];for(hc=
0;hc<La.length;hc++)Da.push(nF(La[hc],ka,U,Y));a.C.ob(Da.join(","));a.C.resize()}else 6==hc&&(pa=!0,Da=nF(La[0],ka,U,Y),null!=Da&&(Da=Da.substring(1),La=!!eE(Da),Da=(hc=gE(Da,a.Ch,!1,!0))?iE(hc.rect,hc.Ah):Da,La||(Da=fE(Da)),a.bb.ob(Da)));else a.F.Ve(0),pa=!0;L(a.Yc,u);a.$.setVisible(w);a.Ra.setVisible(y);a.Wa.setVisible(B);L(a.H,f);L(a.V,h);L(a.O,m);L(a.Aa,r);L(a.L,k);L(a.ma,l);L(a.Jb,J);L(a.Kb,J);L(a.Qb,!0);L(a.ub,R);a.C.resize();L(a.Gb,pa);null!=b&&YNd(a,b)}else{if(I(H(),"feadv")){w=lI(a.Ch);y=
w.Oc();B=new Um;for(J=y.yc();J<y.$c();J++)for(R=y.xc();R<y.bd();R++)pa=w.bh(J,R),""!=yF(pa)&&Vm(B,yF(pa).split(KNd));B.isEmpty()?w=!1:(ZNd(a),a.C.ob(B.xd().join(",")),P2(a,3),WNd(a),w=!0)}else w=!1;w||ZNd(a)}a.qIa();c=c||"";w=c.lastIndexOf("</strong>");-1!=w&&(c=Sb(Nb(c.substring(w+9))));a.sb.zc(!!c);c&&($Nd(a)!=c&&a.mla(),a.J.value=c,L(a.Gc,!0));VNd(a,d)}
p.Xa=function(){this.Qb=this.Cb=this.zb=this.J=this.Yc=this.rb=this.jb=this.ma=this.L=this.Aa=this.O=this.V=this.H=null;C(this.bb);this.bb=null;C(this.Cb);this.Cb=null;C(this.Wa);this.Wa=null;C(this.Ra);this.Ra=null;C(this.$);this.$=null;C(this.F);this.F=null;C(this.sb);this.sb=null;C(this.Nb);this.Nb=null;INd.oa.Xa.call(this)};function kOd(a,b,c,d,e,f,h){yq.call(this);this.Kb=a;this.Pe=b;this.Cb=c;this.Be=d;this.O=e;this.sb=f;this.Jb=h;this.ma=new M(this.qa());this.Ya(this.ma);this.Yc=new kr("",new QT,this.qa());this.Ya(this.Yc);this.ub=new M(this.qa());this.Ya(this.ub);this.ib=new OT(!1,"#4285f4");this.Ya(this.ib);this.yd=new RT(c,lOd.Pca,lOd.Qca);this.xa(this.yd);this.F=this.Ra=null;this.fd=new Rh(this);this.xa(this.fd);this.Gb=this.Aa=this.J=this.C=null;this.rb=I(H(),"fedvs");this.zb=this.L=null;this.Nb=-1;this.mc=[];
this.Wb=[];this.Cd=-1;a=rE(this.Cb).Oc();this.Fe=Nw(a.yc(),a.xc(),a.$c(),a.bd());this.Qb=!1;this.Gc=new Rh(this);this.xa(this.Gc);this.Aa=new Lq;this.Aa.set("save","Save",!1);this.Aa.set("clear","Remove validation",!1,!1);this.Aa.set("cancel","Cancel",!1,!0);Oq(this,this.Aa);Kq(this,!1);this.render();a=this.Ob();b=this.qa();c=lOd;zq(this,"Data validation");this.J||(d=b.Ma("DIV",{"class":c.dVa}),e=b.Ma("DIV",{"class":c.cVa},d),b.appendChild(a,e),this.J=new zp(e),this.J.setType("warning"),this.J.setContent(""),
this.J.render(d),Kwa(this.J,!0),this.J.setVisible(!1));this.rb&&(e=b.Ma("DIV",c.A0a),f=b.Ma("DIV",{id:mOd.mva},"Suggested validations"),d=b.Ma("DIV",c.z0a),h=b.Ma("DIV",c.Ata,"Send feedback"),b.appendChild(a,e),b.appendChild(e,h),b.appendChild(e,f),b.appendChild(a,d),this.Yc.yb(h),L(h,Tz),this.ma.yb(d),e=b.Ma("DIV",c.d0a),b.appendChild(d,e),this.ub.yb(e),this.ib.render(e),PT(this.ib,!0));this.Ra=b.Ma("TABLE",{cellSpacing:"0","class":c.yA},b.Ma("TBODY"));b.appendChild(a,this.Ra);this.rb&&Kh(this.Ra,
c.H0a);a=this.Ob();a=Qd(a);b=a.Ma("TR",lOd.Z0a);b.appendChild(a.Ma("TD","waffle-dv-label",a.Ma("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));c=a.Ma("TD",{colspan:"7"});this.C=SNd(this,c);nOd(this);b.appendChild(c);a.appendChild(this.Ra.childNodes[0],b);(a=this.C.rr())&&Dh(a,"labelledby","waffle-dv-cell-range");this.F=new INd(this,this.Kb,this.O);br(this,"save");oOd(this)}x(kOd,yq);
var lOd={cVa:"waffle-input-error-butter-container",dVa:"waffle-input-error-butter-wrap",Ata:"waffle-dv-feedback-link",Pca:"waffle-dv-highlight-styled-border",Qca:"waffle-dv-highlight-styled-rect",Sta:"waffle-input-error",d0a:"waffle-dv-rec-spinner-container",Mda:"waffle-dv-rec-chip-selected",z0a:"waffle-dv-rec-wrapper",A0a:"waffle-dv-recs-title-bar",yA:"waffle-dv-table",H0a:"waffle-dv-table-with-suggestions",Z0a:"waffle-dv-trrules"},mOd={mva:"waffle-dv-recs-title"};p=kOd.prototype;p.cl=0;
function nOd(a){if(a.C){var b=a.Kb.getActiveGrid();b&&(b=iE(rE(a.Cb).Oc(),b.Wd(),!0),a.C.ob(b))}}function oOd(a){a.fd.R(a,"dialogselect",a.uYb).R(a.F,"error",a.Zrb).R(a.F,"change",a.tYb).R(a.C,"change",function(){a.F&&cOd(a.F);if(a.rb){var b=N2(a);a.Qb||a.L&&b&&b.intersects(UR(a.O,a.zb))||pOd(a)}});a.rb&&a.fd.R(a.sb,"recommender-calc-ended",a.sYb).R(a.Yc,"action",function(){K.Ys.dc({source:"dataValidationDialogFeedback"})})}p.Zrb=function(){qOd(this)};
p.tYb=function(){qOd(this);Rq(this.Aa,"save",!0)};function rOd(a){var b=a.qa();a=a.ma.qb();var c=N(HNd);b.appendChild(a,c)}
p.sYb=function(a){var b=this;PT(this.ib,!1);L(this.ub.qb(),!1);a=a.C;if(0==a.length)rOd(this);else for(var c=this.qa(),d=this.ma.qb(),e=0,f={Ue:0};f.Ue<a.length;f={cN:f.cN,qD:f.qD,b0:f.b0,Ue:f.Ue,hf:f.hf,kD:f.kD},f.Ue++){var h=a[f.Ue],k=V(h,13);if(3<=e||!k)break;e++;f.hf=OR(h);f.b0=iE(qx(f.hf));f.qD=V(k,3);this.mc.push(f.qD);this.Wb.push(f.b0);h="";switch(Wv(f.qD)){case 14:h="Is valid email";break;case 15:h="Is valid URL";break;case 30:h="Is valid date";break;case 24:h="List: "+Xv(f.qD).map(function(a){return V(a.uo().eb(),
2)}).join();break;case 1:h="Greater than "+V(Xv(f.qD)[0].uo().eb(),3);break;case 7:h=Xv(f.qD);h="Between "+(V(h[0].uo().eb(),3)+(" and "+V(h[1].uo().eb(),3)));break;case 5:h=Xv(f.qD);h="Equal to "+V(h[0].uo().eb(),3);break;default:Gkc.C("Unrecognized data validation type.")}k=mOd;f.kD=N(GNd,{description:h,iQb:f.b0});f.cN=new yr("",c);f.cN.We(8,!0);f.cN.yb(f.kD);Dh(f.kD,"describedby",k.mva);this.ma.Ya(f.cN);c.appendChild(d,f.kD);this.Gc.R(f.cN,"action",function(a){return function(){sOd(b,a.cN,a.qD,
a.b0,a.Ue)}}(f)).R(f.kD,"mouseenter",function(a){return function(){ST(b.yd,px(a.hf))}}(f)).R(f.kD,"mouseleave",function(){TT(b.yd)}).R(f.kD,"focus",function(a){return function(){mi(a.kD,d)}}(f))}};function sOd(a,b,c,d,e){var f=lOd,h=Jh(b.qb(),f.Mda);a.ma.mf(function(a){a.$j(f.Mda,!1);a.wc(!1)});b.$j(f.Mda,!h);b.wc(!h);a.Qb=!0;h?(a.show(!0),a.L=null,a.zb=null,a.Nb=-1):(b=new Zv,W(b,1,c),jOd(a.F,b,null,null,!0),dOd(a.F),a.C.ob(d),a.L=c,a.zb=d,a.Nb=e);a.Qb=!1}
p.uYb=function(a){if("save"==a.key){if(!tOd(this)){a.preventDefault();return}}else if("clear"==a.key&&!uOd(this)){a.preventDefault();return}this.C&&this.C.mb(!1)};function qOd(a){var b=vOd(a.cl);b&&a.J.setContent(b);a.J.setVisible(0!=a.cl);b=2==a.cl||4==a.cl;var c=lOd,d=a.qa().Fw(a.C.getElement());Oh(d,c.Sta,b);b&&a.C.rr().select()}
function vOd(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date";case 8:return"Please enter a valid ticked value.";case 9:return"Enter different values for ticked and unticked cell contents.";case 10:return"Formulas are not permitted as custom ticked/unticked values."}return null}
function wOd(a){var b=a.F,c=M2(b);if(0==c){c=b.L;var d=b.ma,e=eOd(b,c),f=eOd(b,d);e&&f?b.D.cl=0:(e||L2(c),f||L2(d),b.D.cl=1)}else if(1==c)c=b.O,d=b.Aa,e=!yi(c)||!Kb(Zb(c.value)),f=!yi(d)||!Kb(Zb(d.value)),e&&f?b.D.cl=0:(e||L2(c),f||L2(d),b.D.cl=6);else if(2==c)c=b.H,d=b.V,e=!yi(c)||!Kb(Zb(c.value)),f=!yi(d)||!Kb(Zb(d.value)),e&&f?b.D.cl=0:(e||L2(c),f||L2(d),b.D.cl=7);else if(3==c||4==c)c=0,4==M2(b)?(d=iOd(b),TR(b.Wb,d)?(d=iOd(b),d=UR(b.Wb,d),e=N2(b.D),null!=d&&null!=e&&d.C==e.C&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==M2(b)&&b.C.getElement()&&Kb(Zb(b.C.eb()))&&(c=5),d=c,c=0==d,b.D.cl=d,d=b.Gb&&yi(b.Gb),b.ub&&yi(b.ub)?(Oh(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.qa().Fw(b.bb.getElement()),Oh(d,"waffle-input-error",!c),b.bb.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error");else if(6==c){if(b.ib.isChecked()){c=b.jb;e=b.rb;d=Nb(Zb(c.value));e=Nb(Zb(e.value));f="true"==d.toLowerCase()&&"true"==e.toLowerCase()||"false"==d.toLowerCase()&&"false"==e.toLowerCase();
var h=gc(d)==gc(e);f=d==e||h||f;Kb(d)?(L2(c),b.D.cl=8):f?b.D.cl=9:NC(d)||NC(e)?b.D.cl=10:b.D.cl=0}}else b.D.cl=0;b=a.C.eb();b=TR(a.O,b);2==a.cl&&b?a.cl=0:0!=a.cl||b||(a.cl=2);qOd(a);return 0!=a.cl}
function tOd(a){if(wOd(a))return!1;var b=a.F,c=b.Nb.isChecked("rejectInvalidData_radio"),d=$Nd(b);b.sb.isChecked()||(d="");var e=hOd(b);if(!e)return!1;var f=new Ox;W(f,1,e);W(f,2,d);W(f,3,c);Azc(f,yi(b.Qb)&&b.Cb.isChecked());b=xOd(a);if(!b)return!1;c=new Gg;e=$v(e);d=a.L&&Wv(a.L)==Wv(e);var h=Xv(e);if(d){var k=yOd(a,pNd(a.O,a.zb)),l=zOd(a);k=rx(k,b);G(c,12,!l||!k);var m=new sNd;G(m,1,!k);G(m,2,!l);G(m,3,a.Nb);aP(c,17,Wfa[0],m)}else{for(var r=m=k=l=!1,u=!1,w=0;w<a.Wb.length;w++){var y=yOd(a,pNd(a.O,
a.Wb[w]));if(y){var B=rx(y,b);y=XYa(y,b);var J=a.mc[w],R=Wv(J)==Wv(e);J=Xv(J);J=yb(J,h,function(a,b){return a.equals(b)});u|=J;l|=B&&R&&J;k|=B;m|=B&&R;r|=y}}w=new tNd;G(w,1,l);G(w,2,k);G(w,3,m);G(w,4,r);G(w,5,u);aP(c,18,Wfa[0],w)}szc(c,YHc(Wv(e)));l=ha(a.mc);for(k=l.next();!k.done;k=l.next())nNd(c,YHc(Wv(k.value)));l=Fa()-a.Cd;G(c,14,l);l=new Eg;$f(l,58,c);c=Pj(Qj(new Oj,l),1).build();a.Jb.Yb(d?35578:35301,c);31==Wv(e)&&a.Jb.Yb(0<h.length?35604:35603,c);a.Be.C(new BIc(f,b));return!0}
function zOd(a){var b=hOd(a.F);if(!b||!a.L)return!1;b=Xv($v(b));a=Xv(a.L);return yb(a,b,function(a,b){return a.uo().eb().equals(b.uo().eb())})}
function uOd(a){var b=xOd(a);if(!b)return!1;try{if(!hOd(a.F))return a.Jb.Yb(35300),!0;var c=$v(hOd(a.F)),d=a.L&&Wv(a.L)==Wv(c),e=!1,f=new Gg;if(d){var h=Dlb(rE(a.Cb).bp().Mc(),pNd(a.O,a.C.eb()));gk(h,function(a){BF(a)&&(e=!0);return e});if(!e){var k=new tNd;G(k,6,!0);aP(f,18,Wfa[0],k)}}var l=new Eg;$f(l,58,f);var m=Pj(Qj(new Oj,l),1).build();a.Jb.Yb(35300,m);return!0}finally{a.Be.C(new BIc(new Ox,b))}}function xOd(a){var b=pNd(a.O,a.C.eb());return yOd(a,b)}
function yOd(a,b){var c=a.C.eb();a=(a=UR(a.O,c))?a.C:null;return b&&null!=a?jx(b,a):null}function N2(a){var b=a.C.eb();return UR(a.O,b)}function SNd(a,b){var c=a.Kb.C.Wd();a=new ET(a.Cb,v(a.rYb,a),!1,"e.g. Sheet1!A2:D5",!0,c,a.qa());a.render(b);return a}p.setVisible=function(a){kOd.oa.setVisible.call(this,a);a&&this.Gb&&(this.Gb.focus(),this.Gb=null)};p.rYb=function(a,b,c,d){this.Gb=a.rr();this.Pe.Cba(this,a,b,c,!1,!0,d)};
p.show=function(a){var b="",c=!1,d=lI(this.Kb),e=BF(cG(d,iG(d)));d=null;var f=!1;e&&(e=e.Qx,d=V(e,1),b=V(e,2),c=V(e,3),f=V(e,4));jOd(this.F,d,b,c,f);(b=hOd(this.F))&&$v(b);this.setVisible(!0);this.C&&this.C.mb(!0);nOd(this);dOd(this.F);pOd(this,a);this.Cd=Fa()};
function pOd(a,b){a.rb&&!b&&(Lzc(a.sb)?(PT(a.ib,!0),L(a.ub.qb(),!0),a.ma.Dd(!0),a.Gc.Pc(),Gzc(a.sb),b=N2(a),null==b||Tw(b.rect)||b.rect.equals(a.Fe)?uAc(a.sb,!0,!1,[6]):tAc(a.sb,!0,!1,!1,[6],[N2(a).rect])):(PT(a.ib,!1),L(a.ub.qb(),!1),rOd(a)))}p.Xa=function(){C(this.F);this.F=null;C(this.C);this.Aa=this.Ra=this.C=null;C(this.J);kOd.oa.Xa.call(this)};function AOd(a,b,c,d,e){yq.call(this);this.sb=c;this.zb=d.C;this.rb=d;this.Wb=e;this.ub=null;this.Kb=d.$;zq(this,"Find and replace");Kq(this,!1);c=this.Ob();d=Qd(c);this.C=d.Ma("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C.value=a;this.ib=d.Ma("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F=new qM(null);this.xa(this.F);this.Gc=b;this.O=new ET(this.sb,v(this.xYb,this),!1,"",!0);this.xa(this.O);this.Aa=null;this.ma=new Ft;this.xa(this.ma);this.Ra=new Ft;this.xa(this.Ra);
this.L=new Ft;this.xa(this.L);this.J=new Ft;this.xa(this.J);this.Qb=this.Gb=this.Jb=this.Nb=!1;this.Cb=d.Ma("SPAN");DBc(this.Cb);this.mc=new os(this.C);this.xa(this.mc);a=BOd;d.Ma("LABEL",{"for":a.Dta},"Search");b=d.Ma("LABEL",{"for":a.wua},"Match case");e=d.Ma("LABEL",{"for":a.xua},"Match entire cell contents");var f=d.Ma("LABEL",{},"Also search within formulae"),h=d.Ma("LABEL",{"for":a.Zua},"Search using regular expressions "),k=(new Cl(C3a)).toString(),l=d.Ma("SPAN",null,d.Ma("A",{target:"_blank",
href:k},"Help"));this.getHandler().R(l,["keydown","keypress"],function(a){13==a.keyCode&&a.stopPropagation()});k=Ji(this,"findLabel");var m=Ji(this,"replaceLabel"),r=Ji(this,"findScopeLabel"),u=d.Ma("DIV","goog-inline-block"),w=d.Ma("DIV",a.y_a);l=d.Ma("TABLE",null,d.Ma("TBODY",null,d.Ma("TR",null,d.Ma("TD",a.LABEL,d.Ma("LABEL",{id:k},"Find")),d.Ma("TD",null,this.C)),d.Ma("TR",null,d.Ma("TD",a.LABEL,d.Ma("LABEL",{id:m},"Replace with")),d.Ma("TD",null,this.ib)),d.Ma("TR",null,d.Ma("TD",null,d.Ma("LABEL",
{id:r},"Search")),d.Ma("TD",null,u,w)),d.Ma("TR",null,d.Ma("TD",null,""),d.Ma("TD",null,b,d.Ma("BR"),e,d.Ma("BR"),h,l,d.Ma("BR"),f)),d.Ma("TR",null,d.Ma("TD",{colspan:"2"},this.Cb))));this.F.render(u);Kh(this.F.getElement(),a.Dta);this.O.render(w);Ii(this.ma,b);Dt(this.ma,b);this.ma.getElement().id=a.wua;Ii(this.Ra,e);Dt(this.Ra,e);this.Ra.getElement().id=a.xua;Ii(this.L,h);Dt(this.L,h);this.L.getElement().id=a.Zua;Dt(this.J,f);Ii(this.J,f);Dh(this.C,"labelledby",k);Dh(this.ib,"labelledby",m);Dh(this.F.qb(),
"labelledby",r);d.appendChild(c,l);c=new Lq;c.set("findNext","Find",!0);c.set("replace","Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);Oq(this,c);br(this,"");this.getHandler().R(this,"dialogselect",this.yYb).R(this.mc,"input",this.xma).R(this.L,"change",this.bAb).R(this.F,"change",this.dqb).R(this.O,"change",this.zYb).R(this.J,"change",this.cAb);c=new ps;c.yb(this.C);this.xa(c);c=new ps;c.yb(this.ib);this.xa(c);COd(this);c=new wq(this.getElement());this.xa(c);this.getHandler().R(c,
"focusin",this.HTa).R(this.getElement(),"mousedown",this.HTa)}x(AOd,yq);var BOd={Vsa:"waffle-find-replace-dialog-border",Dta:"waffle-find-replace-find-scope-select",Sta:"waffle-input-error",LABEL:"waffle-find-replace-dialog-label",wua:"find-replace-case",xua:"find-replace-cell",Zua:"find-replace-regex",y_a:"waffle-find-replace-selection-input goog-inline-block"};
function COd(a){var b=rE(a.sb),c=null,d=null;b&&(c=ISb(b),d=vA(a.zb,c.C).Wd());a.J.zc(a.Kb);var e=new Kk("All sheets",Wbb.GUa),f=new Kk("This sheet",Wbb.H_a),h=new Kk("Specific range",Wbb.aE);a.F.Ad(e);a.F.Ad(f);a.F.Ad(h);f=c?ZG(a.zb,c.C):null;f=(f=c&&f?FF(f,c.rect.yc(),c.rect.xc()):null)?f.hh():1;c&&c.rect.hh()>f?Nr(a.F,h):Nr(a.F,e);b&&a.O.ob(iE(c.rect,d))}function DOd(a){var b=a.F.Te().tb(),c=tA(a.sb.C);return 0==b?gE(a.O.eb(),a.zb,!1,!0):1!=b||null===c?null:new fx(c,"",new Mw(0,0,1,1))}p=AOd.prototype;
p.HTa=function(a){a.target==this.getElement()?this.focus():this.Wb.Pb(2)};p.zYb=function(){EOd(this)};p.cAb=function(){var a=this.J.isChecked();gec(this.rb,a)};p.dqb=function(){EOd(this)};p.bAb=function(){this.L.isChecked()&&this.ma.zc(!0);this.xma()};
p.yYb=function(a){var b=FOd;if("findNext"==a.key)a.preventDefault(),this.Nb&&(Q2(this,null),GOd(this,b.Cta));else if("replace"==a.key)a.preventDefault(),this.Jb&&(Q2(this,null),GOd(this,b.Pua));else if("replaceAll"==a.key&&(a.preventDefault(),this.Qb)){a=v(function(){Q2(this,null);GOd(this,b.Oua)},this);var c=this.F.Te().tb();1<this.zb.D.length&&2==c&&!this.Gb?(ezc("Replace on all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.Gb=!0):a()}};
p.xma=function(){var a=0==this.C.value.length,b=this.L.isChecked()&&!ritz_api.RitzModelApi.isValidRegex(this.C.value);a=!a&&!b;Pq(this.D,"findNext").disabled=!a;this.Nb=a;HOd(this,a);this.Jb&&!a&&IOd(this,!1);Oh(this.C,"waffle-input-error",b)};p.xYb=function(a,b,c){this.ub=a.rr();this.Gc.Cba(this,a,b,c,!1,!0)};
function EOd(a){var b=0==a.F.Te().tb();a.O.setVisible(b);C(a.Aa);a.Aa=null;var c=DOd(a),d=rE(a.sb);b&&d&&c&&(a.Aa=CL(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.Aa.setVisible(!0),a.xa(a.Aa))}function GOd(a,b){if(0==a.F.Te().tb()&&null==DOd(a))Oh(a.O.D,"waffle-range-selection-error",!0),Q2(a,"Invalid range");else{var c=a.F.Te().tb();a.dispatchEvent(new JOd(b,a.C.value,a.ib.value,c,a.ma.isChecked(),a.Ra.isChecked(),a.L.isChecked(),a.J.isChecked(),DOd(a)))}}
p.setVisible=function(a){var b=this.rb.Nd();HOd(this,!b);IOd(this,!b);this.ib.disabled=b;AOd.oa.setVisible.call(this,a);a&&this.ub&&(this.ub.focus(),this.ub=null)};p.zSb=function(a){this.C.value=a};p.fQa=function(){this.C.select()};p.focus=function(){this.Sb()&&this.isVisible()&&(this.C.focus(),this.Wb.Pb(2),Ks(this.C,this.C.value.length),this.xma())};function IOd(a,b,c){b=b&&!a.rb.Nd()&&0==!a.C.value.length;a.Jb=b;a=Pq(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}
function HOd(a,b){b=b&&!a.rb.Nd()&&0==!a.C.value.length;a.Qb=b;Pq(a.D,"replaceAll").disabled=!b}function Q2(a,b){var c=Qd(a.Ob());a=a.Cb;b?(0<pe(a).length&&c.appendChild(a,c.Ma("BR")),c.appendChild(a,c.Ma("B",null,Ie(c,b)))):c.Dd(a)}p.Xa=function(){AOd.oa.Xa.call(this);this.Gb=!1;gec(this.rb,this.Kb)};function JOd(a,b,c,d,e,f,h,k,l){D.call(this,a);this.D=b;this.F=c;this.C=d;this.O=e;this.V=f;this.Ra=h;this.Wa=k;this.bb=l||null}x(JOd,D);
var FOd={Cta:"findnext",Ccc:"findall",Pua:"replace",Oua:"replaceall",DONE:"done",z4b:"canceled"};function KOd(a,b,c,d,e){A.call(this);var f=FOd;this.F=null;this.C=a;this.D=b;this.H=c;this.O=d;this.L=e;this.J=new Rh(this);this.xa(this.J);this.J.R(a,f.Oua,this.izb).R(a,f.Pua,this.jzb).R(a,f.Cta,this.GTa).R(a,f.DONE,this.job)}x(KOd,A);var R2={vN:"cg",wN:"cr",uN:"cc",Bta:"loop"};p=KOd.prototype;p.vUb=function(){this.C.setVisible(!0);LOd(this,null)};p.GTa=function(a){if(sE(this.D.C)){var b=rE(this.D).tb(),c=this.F;c||(c=iG(b),c=Fc(R2.vN,b.Cc(),R2.wN,b.L.C[c.y],R2.uN,b.re.C[c.x]));MOd(this,a,b,c)}};
function MOd(a,b,c,d){var e=new xv,f=NOd(b);OOd(f,c,d);c=e.serialize(f);a=v(function(a){var c=e.kd((new Zbb).Ba(),a);a=V(f,1);var d=b.type;sE(this.D.C)&&(c?mv(c,1)?(d=V(c,1),c=Fc(R2.vN,parseInt(d.Ib(),10),R2.wN,d.Xp(),R2.uN,d.getColumnIndex(),R2.Bta,V(c,2)),POd(this,a,c)):(POd(this,a,{}),"replace"==d&&this.C.focus()):QOd(this))},a);ritz_api.RitzModelApi.findNext(c,a)}function OOd(a,b,c){if(c){var d=""+c[R2.vN],e=new Ew;W(e,1,d);W(e,2,oNd(b,c[R2.wN],"r"));W(e,3,oNd(b,c[R2.uN],"c"));W(a,10,e)}}
function NOd(a){var b=new SC;W(b,1,a.D);W(b,3,a.F);W(b,5,a.C);if(0==a.C||1==a.C){var c=a.bb,d=new Lv;W(d,1,""+c.C);var e=c.rect.yc();W(d,2,e);Mv(d,c.rect.$c());d.gr(c.rect.xc());d.Dx(c.rect.bd());b.setSelection(d)}W(b,6,a.O||!1);W(b,7,a.V||!1);W(b,8,a.Ra||!1);b.setType(a.Wa?1:0);W(b,11,0);return b}function POd(a,b,c){c?c&&null!=c.cg?(b=c[R2.vN],c[R2.Bta]&&Q2(a.C,"No more results found, looping around"),a.H.hA(b,v(a.wYb,a,c))):(LOd(a,null),Q2(a.C,"There are no entries matching "+b)):QOd(a)}
p.wYb=function(a){var b=rE(this.D).tb(),c=a[R2.wN],d=a[R2.uN];a[R2.wN]=b.L.C[c];a[R2.uN]=b.re.C[d];LOd(this,a);a=new Jd(d,c);b=new fx(b.Cc(),"",Pw(a));VR(this.H,b,v(this.e2a,this,a))};
p.e2a=function(a){if(!this.isDisposed()){this.C.focus();var b=rE(this.D).tb();zF(b.bh(a.y,a.x))&&!this.C.J.isChecked()&&IOd(this.C,!1,"Can't replace formula");var c=UF(b,a.y),d=VF(b,a.x);!c||!d||c.isVisible()&&d.isVisible()||(c=this.C,d=hE(a),a=yF(cG(b,a)),Q2(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function QOd(a){Q2(a.C,null);Q2(a.C,"Error while searching spreadsheet. Please try again.")}
p.jzb=function(a){if(!this.L.Nd()){var b=this.F;if(b){var c=uF(this.H,b[R2.vN]);if(c){var d=c.Mc(),e=oNd(d,b[R2.wN],"r"),f=oNd(d,b[R2.uN],"c");c=d.bh(e,f);if(!zF(c)||this.C.J.isChecked()){c=yF(c);var h=new xv,k=NOd(a);W(k,5,0);OOd(k,d,b);d=new Lv;W(d,1,""+b[R2.vN]);W(d,2,e);Mv(d,e+1);d.gr(f);d.Dx(f+1);k.setSelection(d);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);ROd(this,k,c,b,!1);this.GTa(a)}}}}};p.izb=function(a){if(!this.L.Nd()&&sE(this.D.C)){var b=NOd(a);ROd(this,b,a.D,a.F,!0)}};
function ROd(a,b,c,d,e){b=new RKc(b);YD(b,v(function(a,b){a?(a=V(b,5),b=V(b,4),b=0==a?"No matches found":e?(new kt(1==b?"{NUM_CHANGED,plural, =0{unused plural form}=1{Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other{Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS,plural, =0{unused plural form}=1{unused plural form}other{Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:a,NUM_SHEETS:b,ORIGINAL_VALUE:c,
NEW_VALUE:d}):'Replaced "'+(c+('" with "'+(d+'"'))),Q2(this.C,null),Q2(this.C,b)):QOd(this)},a));Q2(a.C,null);Q2(a.C,"Working...");a.O.C(b)}p.job=function(){LOd(this,null)};function LOd(a,b){a.F=b;(a=a.C)&&IOd(a,null!=b)};function SOd(a,b,c){rNd.call(this);zq(this,"Grouping rule");this.Aa=a;this.ib=b;this.Ra=c;this.ma=new M;this.Ya(this.ma,!0);this.F=new TOd("Minimum value","e.g. 0",!0);this.ma.Ya(this.F,!0);this.L=new TOd("Maximum value","e.g. 100",!0);this.ma.Ya(this.L,!0);this.J=new TOd("Interval size","e.g. 10",!1);this.Ya(this.J,!0);(a=this.Aa.C.getActiveGrid())&&(a=uG(a.Mc()))&&(a=UOd(this,a))&&mv(a,10)&&mv(by(a),3)&&(a=V(by(a),3),mv(a,1)&&(b=V(a,1),this.F.D.ob(AU.format(b))),mv(a,2)&&(b=V(a,2),this.J.D.ob(AU.format(b))),
mv(a,3)&&(a=V(a,3),this.L.D.ob(AU.format(a))))}q(SOd,rNd);
SOd.prototype.u7=function(){var a=VOd(this.F),b=VOd(this.J),c=VOd(this.L);if(isNaN(a)||isNaN(b)||isNaN(c))var d=!1;else 0>=b?(WOd(this.J,"Must be greater than 0"),d=!1):null!=a&&null!=c&&a>=c?(WOd(this.F,"Value too large"),d=!1):d=!0;if(d){d=new cy;d.setType(2);var e=new fy;null!=a&&W(e,1,a);null!=b&&W(e,2,b);null!=c&&W(e,3,c);W(d,3,e);if(a=this.Aa.C.getActiveGrid())if(a=a.Mc(),b=uG(a))if(c=UOd(this,b))W(c,10,d),this.ib.C(new UM(b,a)),jA("Pivot table headings grouped.");rNd.prototype.u7.call(this)}};
function UOd(a,b){b=Rjb(b,function(b){return b.PX()==a.Ra});if(0==b.length)return null;if(1==b.length)return b[0];if(2==b.length)return mv(b[0],10)?b[0]:b[1]}function TOd(a,b,c,d){M.call(this,d);this.L=a;this.O=b;this.V=c;this.J=new M;this.Ya(this.J,!0);this.D=new IT;this.Ya(this.D,!0);this.H=null;this.C=new M;this.Ya(this.C,!0);this.F=new rS(this.qa(),!0,!0);this.xa(this.F)}q(TOd,M);
TOd.prototype.Za=function(){M.prototype.Za.call(this);this.qb().className="waffle-pivot-histogram-errorable-input";this.J.qb().className="waffle-pivot-histogram-dialog-caption";this.qa().Qe(this.J.getElement(),this.L);this.H=this.D.Rd().FL(this.D.qb());this.H.placeholder=this.O;Hh(this.H,this.L+" - "+this.O);uS(this.F,this.H);this.C.qb().className="waffle-pivot-histogram-dialog-error";Ch(this.C.qb(),"alert");Dh(this.C.qb(),"live","polite");XOd(this)};
function VOd(a){XOd(a);var b=a.D.eb();if(Kb(b)){if(a.V)return null;WOd(a,"Required");return NaN}b=AU.parse(b);isNaN(b)&&WOd(a,"Must be a number");return b}function WOd(a,b){a.C.qb().style.visibility="";a.qa().Qe(a.C.qb(),b);sS(a.F,b,!1)}function XOd(a){a.C.qb().style.visibility="hidden";tS(a.F)};function YOd(a){a=a||{};var b=a.type;return P('<input class="'+Q("jfk-textinput")+(a.Hd?" "+Q(a.Hd):"")+'"'+(a.id?' id="'+Q(a.id)+'"':"")+(a.maxLength?' maxlength="'+Q(a.maxLength)+'"':"")+(a.i$&&a.UVb?' label="'+Q(a.i$)+'"':"")+(a.name?' name="'+Q(a.name)+'"':"")+(a.i$?' placeholder="'+Q(a.i$)+'"':"")+' type="'+Q(null!=b?b:"text")+'"'+(a.pattern?' pattern="'+Q(a.pattern)+'"':"")+(a.value?' value="'+Q(a.value)+'"':"")+(a.dir?' dir="'+Q(a.dir)+'"':"")+(a.attributes?" "+fEa(a.attributes):"")+">")};function ZOd(a){a=""+$Od({id:"waffle-resize-selection-custom",uKa:a.Gga,Qk:qr("<br/>"+O(YOd({id:"waffle-resize-input",Hd:"waffle-resize-inset-input"})))});a+=$Od({id:"waffle-resize-selection-auto",uKa:pr("Fit to data"),Qk:qr("")});return P(a)}function $Od(a){return P('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+Q(a.id)+'"><label for="'+Q(a.id)+'" class="waffle-resize-label">'+O(a.uKa)+"</label>"+O(a.Qk)+"</div>")}
function aPd(a){var b=a.vcb;a='<label for="waffle-resize-input">'+O(a.Gga)+'</label><br/><br/><input id="waffle-resize-input"/>';b&&(a+='<br/><br/><span class="waffle-resize-dialog-checkbox"><span id="waffle-resize-rows-can-grow-checkbox">Allow row heights to grow automatically to fit cell contents.</span></span>');return P(a)};function bPd(a,b,c,d,e){yq.call(this);this.L=a;this.Ra=b;var f=Xw(this.L.Oc());this.C=f;this.F=Ua(eG(this.L),function(a){return Xw(a)==f});this.J=new LP;this.O=new NKc(!0);this.ma=new Ft;this.ib=c;this.rb=d;this.Aa=e}x(bPd,yq);var cPd={AUTO:"waffle-resize-selection-auto",vr:"waffle-resize-selection-custom",ZXa:"waffle-resize-input",qZa:"waffle-resize-selection",q_a:"waffle-resize-rows-can-grow-checkbox"};p=bPd.prototype;
p.Ma=function(){bPd.oa.Ma.call(this);var a=this.F[0];if("r"==this.C){var b=a.yc();a=a.$c()-1;var c=String($D(b+1)),d=String($D(a+1));b=1<this.F.length?"Resize selected rows":b==a?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else b=a.xc(),a=a.bd()-1,c=bE(b),b=1<this.F.length?"Resize selected columns":b==a?"Resize column "+c:"Resize columns "+(c+(" - "+bE(a)));zq(this,b);"r"==this.C?this.Ob().appendChild(N(aPd,{Gga:dPd(this),vcb:I(H(),"fefrh")})):this.Ob().appendChild(N(ZOd,{Gga:dPd(this)}));br(this,
"ok")};p.Za=function(){bPd.oa.Za.call(this);var a=this.qa(),b="r"==this.C;this.J.yb(a.getElement(cPd.ZXa));I(H(),"fefrh")&&b&&(a=a.getElement(cPd.q_a),Dt(this.ma,a),Ii(this.ma,a));a=this.L.Oc();var c=Xw(a);a=Akb(Clb(this.L,c,Vw(a,c)));this.J.ob(String(a));b||(OKc(this.O,cPd.qZa),PKc(this.O,cPd.vr));this.getHandler().R(this,"dialogselect",this.EYb).R(this.J.getElement(),"focus",this.dEb)};p.dEb=function(){"c"==this.C&&PKc(this.O,cPd.vr)};p.focus=function(){this.Sb()&&PP(this.J)};
function dPd(a){return"r"==a.C?"Enter new row height in pixels. (Default: "+(JF+")"):"Enter new column width in pixels. (Default: "+(Ckb+")")}
p.EYb=function(a){if("ok"==a.key)if((a="r"==this.C)||QKc(this.O)==cPd.vr){var b=parseInt(this.J.eb(),10);isNaN(b)?iA("Entered value is not a number."):2>b||2E3<b?iA("Size must be between 2 and 2000 pixels."):(this.Aa.C("r"==this.C?35310:35308),b=new dN(this.L,this.F[0],b,this.F.slice(1)),I(H(),"fefrh")&&a&&(a=!this.ma.isChecked(),b.L=a),this.Ra.C(b))}else rE(this.ib),this.Aa.C(35307),yXb(this.F,this.rb,this.Ra)};function ePd(a){Tf(this,a,0,-1,null,null)}x(ePd,Sf);ePd.prototype.getType=function(){return F(this,3)};ePd.prototype.setType=function(a){G(this,3,a)};function fPd(a){M.call(this,a);this.$=Xz("email");this.C=this.D=null}x(fPd,M);p=fPd.prototype;
p.Ma=function(){var a=this.qa();var b=this.qa();this.C=new kT;this.xa(this.C);this.D=new kT;this.xa(this.D);var c=b.Ma("DIV","waffle-dialog-notifications-input");Ch(c,"presentation");this.F=new iT;jT(this.F,b.Ma("LABEL",null,"Any changes are made"));this.F.render(c);this.C.HG(this.F);var d=b.Ma("DIV","waffle-dialog-notifications-input");Ch(d,"presentation");this.J=new iT;jT(this.J,b.Ma("LABEL",null,"A user submits a form"));this.J.render(d);this.C.HG(this.J);var e=b.Ma("DIV","waffle-dialog-notifications-input");
Ch(e,"presentation");this.H=new iT;jT(this.H,b.Ma("LABEL",null,"Email - daily digest"));this.H.render(e);this.D.HG(this.H);var f=b.Ma("DIV","waffle-dialog-notifications-input");Ch(f,"presentation");this.L=new iT;jT(this.L,b.Ma("LABEL",null,"Email - straight away"));this.L.render(f);this.D.HG(this.L);b=b.Ma("DIV",null,b.Ma("DIV","waffle-dialog-notifications-toplabel","Notify me at "+(this.$+" when...")),b.Ma("DIV",{role:"radiogroup","aria-label":"Notify me at "+(this.$+" when...")},c,d),b.Ma("DIV",
{style:"padding: 5px"}),b.Ma("DIV","waffle-dialog-notifications-label","Notify me with..."),b.Ma("DIV",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.qa();d=c.Ma("DIV");this.O=sP("Save",c);this.Ya(this.O,!1);this.O.render(d);this.V=new yr("Cancel",c);this.Ya(this.V,!1);this.V.render(d);a=a.Ma("DIV","waffle-dialog-notifications",a.Ma("DIV",null,b),a.Ma("DIV",null,d));this.Lb(a)};
p.Za=function(){fPd.oa.Za.call(this);this.getHandler().R(this.O,"action",this.HRb,!0).R(this.V,"action",v(this.dispatchEvent,this,new D("cancelRuleEdit"))).R(this.C,"change",this.psa).R(this.D,"change",this.psa)};p.Hc=function(a){fPd.oa.Hc.call(this,a);a?1==a.getType()?lT(this.C,this.F):2==a.getType()&&lT(this.C,this.J):lT(this.C,null);a?2==F(a,2)?lT(this.D,this.H):1==F(a,2)&&lT(this.D,this.L):lT(this.D,null);this.psa()};p.focus=function(){var a=mT(this.C),b=this.C.C.Ze(0);(a||b).getElement().focus()};
p.setVisible=function(a){this.getElement()&&L(this.getElement(),a)};p.HRb=function(){this.dispatchEvent(new D("saveRule",gPd(this)))};function gPd(a){var b=new ePd,c=a.tb();c&&(c=F(c,1),G(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?G(b,2,1):a.H.isChecked()&&G(b,2,2);return b}p.psa=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.mb(a)};function S2(a,b){M.call(this,b);this.Hc(a)}x(S2,M);
S2.prototype.Ma=function(){var a=this.tb(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==F(a,2)?c+="send digest email":1==F(a,2)&&(c+="send email");c="If "+(b+(" then "+c));var d=this.qa();a=d.Ma("TD",null);b=d.Ma("TD",{width:"50px"});c=d.Ma("TR",{valign:"center"},d.Ma("TD",null,d.Ma("SPAN","waffle-notification-rule",c)),d.Ma("TD",{align:"right"},d.Ma("TABLE",null,d.Ma("TBODY",null,d.Ma("TR",null,a,b)))));d=Pi(jr,"waffle-notifications-add");this.D=new kr("Edit",
d,this.qa());this.D.Gd("goog-link-button");this.D.Gd("menuMainLink");this.Ya(this.D,!1);this.D.render(a);this.C=new kr("Delete",d,this.qa());this.C.Gd("goog-link-button");this.C.Gd("menuMainLink");this.Ya(this.C,!1);this.C.render(b);this.Lb(c)};S2.prototype.Za=function(){S2.oa.Za.call(this);this.getHandler().R(this.D,"action",this.H);this.getHandler().R(this.C,"action",this.F)};S2.prototype.H=function(){this.dispatchEvent(new D("edit",this.tb()))};
S2.prototype.F=function(){var a=v(function(){this.dispatchEvent(new D("del",this.tb()))},this),b=v(function(){this.C.getElement().focus()},this);ENd("Are you sure that you want to delete this notification rule?",a,void 0,void 0,b)};function hPd(a){M.call(this,a);this.C=null}x(hPd,M);hPd.prototype.Ma=function(){var a=this.qa();this.C=a.Ma("TBODY");a=a.Ma("TABLE",{className:"waffle-dialog-notifications-list",width:"100%"},this.C);this.Lb(a)};hPd.prototype.Ob=g("C");hPd.prototype.setVisible=function(a){this.getElement()&&L(this.getElement(),a)};function iPd(a,b,c){yq.call(this);this.L=b;zq(this,"Set notification rules");Kq(this,!1);a=new Lq;a.set("cancel","Done",!1,!0);Oq(this,a);this.C=new fPd(c);this.Ya(this.C,!1);this.F=new hPd;this.Ya(this.F,!1);this.J=new kr("Add another notification rule",TN.getInstance(),this.qa());this.Ya(this.J,!1)}x(iPd,yq);p=iPd.prototype;
p.Ma=function(){iPd.oa.Ma.call(this);var a=this.qa(),b=Xtb(new Cl(z3a+"91588")).toString();b=a.Ma("A",{target:"_blank",href:b},"Help");var c=a.Ma("DIV");this.J.render(c);this.ma=a.Ma("DIV");this.O=a.Ma("DIV");var d=a.Ma("DIV","waffle-dialog-notifications-bounds",this.ma,this.O);b=a.Ma("DIV",null,a.Ma("DIV",{align:"right"},b),d,c);a.appendChild(this.Ob(),b);br(this,"")};
p.Za=function(){iPd.oa.Za.call(this);this.F.render(this.ma);this.C.render(this.O);this.getHandler().R(this,"edit",this.HYb).R(this,"del",this.GYb).R(this.J,"action",this.FYb).R(this,"saveRule",this.GRb).R(this,"cancelRuleEdit",this.H3a)};p.o_=function(a){this.isDisposed()||(this.C.setVisible(!1),jPd(this,!1),Oz(this.L,"/notifications/list",v(this.CVb,this,a)).Ge())};
p.CVb=function(a,b,c){if(!this.isDisposed()){b=c.nf();c=[];for(var d=0;d<b.length;d++)c[d]=new ePd(b[d]);this.Hc(c);if(a&&0==c.length)kPd(this,null,!1);else{if(a=this.tb())if(b=this.F,b.Dd(!0),b.qa().Dd(b.Ob()),b.Hc(a),c=b.qa(),0==a.length)c.appendChild(b.Ob(),c.Ma("TR",null,c.Ma("TD",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Ya(new S2(a[d],c),!0);jPd(this,!0);this.focus()}}};
p.GRb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();F(a,1)?Ht(Oz(this.L,"/notifications/set",v(this.o_,this,!1)),{rule:b}).Ge():Ht(Oz(this.L,"/notifications/create",v(this.o_,this,!1)),{rule:b}).Ge()};p.H3a=function(){this.C.setVisible(!1);this.o_(!1)};p.HYb=function(a){kPd(this,a?a.target:null,!0)};p.FYb=function(){kPd(this,null,!0)};function kPd(a,b,c){jPd(a,!1);var d=a.C;d.Hc(b);d.setVisible(!0);c&&a.C.focus()}
p.GYb=function(a){this.F.setVisible(!1);a=a.target;Ht(Oz(this.L,"/notifications/delete",v(this.o_,this,!1)),{rule_id:F(a,1)}).Ge()};function jPd(a,b){a.F.setVisible(b);var c=Dq(a);L(c,b);a.J.setVisible(b)}p.show=function(){this.setVisible(!0);this.o_(!0)};function lPd(a,b,c,d,e){XD.call(this,68);this.O=a;this.L=b;this.D=c;this.H=d;this.C=e}x(lPd,XD);lPd.prototype.Vd=function(){var a=new ED;this.O&&W(a,1,this.O);t(this.L)&&W(a,2,this.L);t(this.D)&&W(a,3,this.D);this.H&&W(a,4,this.H);t(this.C)&&W(a,5,this.C);return a};lPd.prototype.IZ=function(a,b){(t(this.D)||t(this.H)||t(this.C))&&ritz_api.RitzModelApi.requestCalculation(!0);lPd.oa.IZ.call(this,a,b)};function mPd(a,b,c){b=c||b;c='<tr class="dialog-settings-general-settings-div"><div>';var d='<span id="ds-settings-link-desc">Display language: </span><a aria-labelledby="ds-settings-link-desc ds-settings-link" id="ds-settings-link" target="_blank">'+(O(a.G5a)+"</a>");c=c+d+"</div>";a.vTb&&(c+='<div class="dialog-settings-english-name-div">'+O(Et({id:"waffle-settings-dialog-english-name-checkbox"},b))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">',
c+="Always use English function names</label></div>");return P(c+"</tr>")}function nPd(){return P('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function T2(a,b,c,d){yq.call(this);this.Nb=a;this.Yc=b;this.ma=c;this.mc=d;this.C={};this.Jb=this.zb=!1;this.Wb=this.Kb=this.Gb="";this.Gc=new xv;this.J=[];this.F=this.Gc.kd((new xw).Ba(),ritz_api.RitzModelApi.getWorkbookProperties());zq(this,"Settings for this spreadsheet");this.ub=!1;this.rb=new Ft;this.Ya(this.rb);this.O=new rS;this.Ya(this.O);this.L=new rS;this.Ya(this.L);this.Cb=new HS;this.Ya(this.Cb);this.ib=this.sb=null;this.Qb=new it(1);this.Aa=this.Ra="";this.C[0]=J2();this.C[1]=J2();this.C[2]=
J2();this.C[3]=J2();this.C[4]=new LP;this.C[5]=new LP}x(T2,yq);var oPd=null,pPd={s2:0,O0a:1,NUa:2,gYa:3,zYa:4,UVa:5},qPd={r1a:"waffle-settings-dialog-english-name-checkbox",s1a:"waffle-settings-dialog-english-name-checkbox-label"},rPd=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],sPd=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];p=T2.prototype;
p.Ma=function(){T2.oa.Ma.call(this);var a=this.Ob(),b=this.qa(),c=[tPd(b,"Locale","waffle-settings-label-locale"),uPd(this,b,"This affects formatting details such as functions, dates and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),vPd(this),tPd(b,"Time zone","waffle-settings-label-timezone"),uPd(this,b,"Your spreadsheet's history will be recorded in this time zone. This will change all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
vPd(this)],d=[];d.push(tPd(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(uPd(this,b,"This affects how often NOW, TODAY, RAND and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(vPd(this));d.push(tPd(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=Xtb(new Cl(z3a+"58515")).toString();e=b.Ma("A",{target:"_blank",href:e}," Learn more about iterative calculation.");d.push(uPd(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",
3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=tPd(b,"Max. number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=uPd(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");wPd(e);d.push(e);this.J.push(e);e=tPd(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=uPd(this,
b,"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");wPd(e);d.push(e);this.J.push(e);"OFF"==this.C[3].Te().eb()&&xPd(this);d.push(vPd(this));c=mb(c,d);c.push(N(mPd,{G5a:this.Kb,vTb:this.ub}));this.sb=b.Ma("TABLE","dialog-settings",b.Ma("TBODY",null,c));this.ib=b.Ma("table","dialog-settings",b.Ma("tbody",null,d));c=N(nPd);b.appendChild(a,c);this.Cb.yb(c);b.appendChild(a,
this.sb);b.appendChild(a,this.ib);L(this.ib,!1);oPd||(a=new Lq(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),oPd=a);Oq(this,oPd);yPd(this,4,mv(this.F,3)&&V(this.F,3).Z7()?V(this.F,3).L5().toString():"50");yPd(this,5,mv(this.F,3)&&V(this.F,3).X7()?V(this.F,3).y5().toString():"0.05");br(this,"save")};function wPd(a){a=a.firstChild.firstChild;Kh(a,"jfk-textinput");$h(a,"width","7em")}function xPd(a){for(var b=0;b<a.J.length;b++)L(a.J[b],!1)}
function tPd(a,b,c){return a.Ma("TR",null,a.Ma("TD",{id:c,"class":"dialog-settings-label"},b))}function uPd(a,b,c,d,e,f,h){b=b.Ma("TR",null,b.Ma("TD","dialog-settings-input"),b.Ma("TD",{id:f,"class":"dialog-settings-text"},c,h));a=a.C[d];a.render(b.firstChild);a=a.qb();Dh(a,"labelledby",e);Dh(a,"describedby",f);return b}function vPd(a){a=a.qa();return a.Ma("TR",null,a.Ma("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.Ma("HR",{"class":"dialog-settings-sep"})))}
p.Za=function(){T2.oa.Za.call(this);jf(this,"dialogselect",v(this.IYb,this));this.getHandler().R(this.C[3],"action",this.KTb);this.getHandler().R(this.Cb,"select",this.HCb);var a=this.C[4].getElement();this.O.Uj(a);uS(this.O,a,a);this.O.render();tS(this.O);this.getHandler().R(a,"change",v(this.ZVb,this));a=this.C[5].getElement();this.L.Uj(a);uS(this.L,a);this.L.render();tS(this.L);this.getHandler().R(a,"change",v(this.YVb,this));if(this.ub){a=this.qa().getElement(qPd.r1a);var b=this.qa().getElement(qPd.s1a);
this.rb.yb(a);Dt(this.rb,b);this.rb.zc(!K3a||Utb(this.ma.F))}};p.setVisible=function(a){if(a){if(!this.zb){zPd(this);return}var b=this.ma.L;yPd(this,0,b.C);b=b.H||t2b().name();yPd(this,1,b);yPd(this,2,mv(this.F,3)&&V(this.F,3).Ola()?V(this.F,3).uia().toString():"");yPd(this,3,mv(this.F,3)&&mv(V(this.F,3),1)?V(V(this.F,3),1)?"ON":"OFF":"OFF")}T2.oa.setVisible.call(this,a);this.zb&&!this.Jb&&((a=Td("ds-settings-link"))&&yd(a,this.Gb),this.Jb=!0)};
function zPd(a){Cs(gu(a.Yc.ef("/info/settings"),APd()),v(function(a){a=a.nf();(a={locale:a.l?this.VJ(a.l):null,qSa:a.tz?this.VJ(a.tz):null,P5a:a.dls,HHb:a.dln,WVb:a.hl},a.locale)&&a.qSa&&(BPd(this,0,a.locale),BPd(this,1,a.qSa),BPd(this,2,rPd),BPd(this,3,sPd),this.Gb=a.P5a,this.Kb=a.HHb,this.Wb=a.WVb,this.ub=K3a&&ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.Wb),this.zb=!0);this.setVisible(!0)},a)).Ge()}
function APd(){var a=Nl(Xz("win").location.href),b=Ll(a,"hl");a=Ll(a,"forcehl");return["hl",b,"forcehl",a]}function BPd(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];e=new Kk(e.caption,e.value);a.Ad(e);Ch(e.getElement(),"menuitem")}a.Ac().getElement().style.overflow="auto";bP(a,!0)}p.VJ=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b};function yPd(a,b,c){(a=a.C[b])&&a.ob(c)}
p.IYb=function(a){"save"==a.key&&("ON"!=this.C[3].Te().eb()||""==this.Ra&&""==this.Aa?(CPd(this),a=this.ma.L.C,this.Nb.C(DPd(this)),this.Nb.C(EPd(this)),FPd(this,a)):(a.preventDefault(),CPd(this),""!=this.Ra&&sS(this.O,this.Ra,!0),""!=this.Aa&&sS(this.L,this.Aa,!0)))};p.KTb=function(a){if("ON"==a.target.eb())for(a=0;a<this.J.length;a++)L(this.J[a],!0);else xPd(this);CPd(this)};function CPd(a){tS(a.O);tS(a.L)}
p.ZVb=function(){this.Ra="";var a=this.C[4].eb()||"";a=this.Qb.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.Ra="Please enter an integer value.";else if(0>=a||1E4<a)this.Ra="Please enter a value between 1 and 10000."};p.YVb=function(){this.Aa="";var a=this.C[5].eb()||"";a=this.Qb.parse(a);isNaN(a)?this.Aa="Please enter a numeric value.":0>a&&(this.Aa="Please enter a non-negative value.")};
p.HCb=function(a){switch(a.target.getId()){case "general-settings-tab":L(this.sb,!0);L(this.ib,!1);break;case "calculation-settings-tab":L(this.sb,!1),L(this.ib,!0)}};function DPd(a){var b=a.C,c=b[pPd.NUa].Te().eb(),d=b[pPd.gYa].Te().eb();a=b[pPd.zYa].eb()||"";b=b[pPd.UVa].eb()||"";var e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new lPd(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}
function EPd(a){var b=a.C;a=a.ma.L;var c=b[pPd.s2].Te();c=null==c?a.C:c.eb();b=b[pPd.O0a].Te();b=null==b?a.H||t2b().name():b.eb();return new z2b(c,b)}function GPd(a,b){a=a.C[0].Te();return null!=a&&a.eb()!=b}function FPd(a,b){(HPd(a)||GPd(a,b))&&Osa(a.ma.D.C,function(){Xz("win").location.reload()})}function HPd(a){if(!a.ub)return!1;var b=!K3a||Utb(a.ma.F),c=a.rb.isChecked();return b!=c?(bub(a.ma,c),b=Pj(new Oj,1).build(),a.mc.Yb(c?2433:2434,b),!0):!1}p.Xa=function(){kc(this.C,C);delete this.C;T2.oa.Xa.call(this)};function IPd(a,b,c,d,e,f,h,k){yq.call(this,void 0,!1,k);this.J=this.L=this.ma=this.O=null;this.ib=a;this.C=b;this.Aa=h;this.F=[];this.Ra=new bjc(a,d,e,f)}q(IPd,yq);p=IPd.prototype;
p.Ma=function(){yq.prototype.Ma.call(this);var a=this.qa(),b=this.C.Oc(),c=hE(cx(b)),d=hE(new Jd(b.left+b.width-1,b.top+b.height-1));zq(this,"Sort range from "+(c+(" to "+d)));JPd||(c=new Lq,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),JPd=c);Oq(this,JPd);br(this,"save");var e;c=a.Ma("DIV",{style:"overflow: hidden"},d=a.Ma("SPAN","jfk-checkbox"),e=a.Ma("SPAN",{style:"cursor: default"},"Data has header row"));var f=this.J=new Ft(void 0,a);f.yb(d);Dt(f,e);1==b.height&&f.mb(!1);sI(this.ib,this.C.Cc(),
b)||(f.zc(!0),f.mb(!1));I(H(),"fetdrisd")&&ritz_api.TablesApi.getTables((new xv).serialize(jx(b,this.C.Cc())),v(function(a){if(0<a.length){var c=a[0];a=mP(c.getDimensionTableAccessor().getHeaderRange());if(c=ritz_api.TablesApi.isRowBased(c)&&1==SYa(hx(a)))c=jx(b,this.C.Cc()),c=a.Ib()==c.Ib()&&OYa(hx(a),hx(c))&&OYa(ix(a),ix(c));c&&f.zc(!0)}},this));d=this.Ob();a.appendChild(d,c);this.O=a.Ma("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.Ma("TABLE",{cellSpacing:"0"},this.ma=a.Ma("TBODY")));
a.appendChild(d,this.O);c=KPd(this);this.F.push(c);c=a.Ma("SPAN","menuMainLink waffle-sd-add","+ Add another sort column");a.appendChild(d,c);ye(c,!0);Ch(c,"button");this.L=c};p.Za=function(){yq.prototype.Za.call(this);this.getHandler().R(this,"dialogselect",this.rJb).vg(this.L,mf,this.Eib).R(this.J,"change",this.crb)};
function KPd(a){var b=a.qa(),c=0==a.F.length,d=new LPd(a,c,a.C,a.F.length,b),e=b.Ma("TR",null,b.Ma("TD",{colspan:"4"},b.Ma("DIV","waffle-sd-row-separator")));d.render(a.ma);b.appendChild(a.ma,e);c||a.getHandler().vg(d.D,mf,v(a.i5a,a,d));a=MPd(a);NPd(d,a);return d}p.i5a=function(a){var b=this.F;if(1<b.length){var c=Sa(b,a);-1!=c&&(kb(b,c),b=a.getElement(),b=re(b),a.dispose(),me(b),L(this.L,!0),this.L.focus(),jA("Sort criteria removed."))}};
function MPd(a){var b=a.C.Oc(),c=b.xc();b=b.bd();var d=Va(a.F,function(a){return a.Pj()},a);if(d)for(var e=Slb(a.C,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=a.C.re.C[f];if(!cb(d,h))return h}return null}p.crb=function(){for(var a=this.F,b=0;b<a.length;b++)NPd(a[b])};p.Eib=function(){var a=ax(this.C.Oc(),"c");a=Math.max(10,a);this.F.length<a&&(this.F.push(KPd(this)),jA("Sort criteria added."));mi(Ra(this.F).getElement(),this.O,!0);this.O.scrollLeft=0;this.F.length>=a&&L(this.L,!1)};
p.rJb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.F,d=0;d<c.length;d++){var e=c[d];a.push(e.Pj());e=e.F.isChecked();b.push(e?1:0)}c=this.C.Oc();d=ax(c,"r");if(this.J.isChecked()&&1<d){d=c.yc()+1;e=c.xc();var f=c.$c(),h=c.bd();c.top=d;c.left=e;c.height=f-d;c.width=h-e}d=Pj(new Oj,1).build();this.Aa.Yb(this.J.isChecked()?35697:35698,d);a=new ajc(a,b,this.C,c,this.J.isChecked());cjc(this.Ra,this.C,a)}};p.Xa=function(){yq.prototype.Xa.call(this);Db(this.F)};var JPd=null;
function LPd(a,b,c,d,e){M.call(this,e);this.J=this.L=this.F=this.C=this.D=null;this.V=-1;this.$=a;this.O=b;this.H=c}q(LPd,M);LPd.prototype.Pj=function(){var a=this.C.Te();return a?a.eb():-1};
LPd.prototype.Ma=function(){var a=this.qa(),b=this.O?"sort by":"then by",c,d,e,f=a.Ma("TR","waffle-sd-tr-rules",a.Ma("TD","waffle-sd-delete",this.O?"":this.D=a.Ma("SPAN",{title:"Remove sort criteria."},"x")),a.Ma("TD","waffle-sd-td-rules",a.Ma("LABEL",{id:Ji(this,"csl")},b)),b=a.Ma("TD","waffle-sd-column-selector"),a.Ma("TD","waffle-sd-td-ascending",e=a.Ma("DIV",null,c=a.Ma("DIV",{title:"Ascending"}),d=a.Ma("DIV",{title:"Descending"}))));Ch(e,"radiogroup");e=this.F=new iT(a,Je(a,Mp(PC(!0,this.we()))),
"ascending");e.render(c);a=this.L=new iT(a,Je(a,Mp(PC(!1,this.we()))),"descending");a.render(d);this.J=new kT([e,a]);lT(this.J,e);a=this.C=J2();a.render(b);Dh(a.getElement(),"label",this.O?"Select first column to sort by:":"Select next column to sort by:");this.D&&(ye(this.D,!0),Ch(this.D,"button"),Hh(this.D,"Remove sort criteria."));this.Lb(f)};
function NPd(a,b){var c=a.qa(),d=a.$.J.isChecked(),e=a.H.Oc(),f=e.yc(),h=e.xc();e=e.bd();a.V=b||a.Pj();for(b=a.C.Yh();0<b;b--)a.C.IB(0);for(;h<e;h++)b=Ub(yF(a.H.bh(f,h)),25),b=new Kk(Kb(b)||!d?"Column "+bE(h):b,a.H.re.C[h],c),b.Gd("waffle-sd-menu-item"),a.C.Ad(b);a.C.Ve(0);0<=a.V&&a.C.ob(a.V)}LPd.prototype.Xa=function(){M.prototype.Xa.call(this);this.C=this.D=this.H=this.$=null;C(this.F);C(this.L);C(this.J);this.J=this.L=this.F=null};function OPd(a){return P("<li class='nfd-format-pill'><div class='nfd-format-display'>"+O(a.mdb)+"</div><div class='nfd-format-sample'>"+O(a.VQb)+"</div></li>")};function PPd(a,b,c){M.call(this);this.Hc(a);this.D=b;this.C=c}x(PPd,M);p=PPd.prototype;p.Ma=function(){var a=this.tb(),b=this.C?cba(a.Qy(),30):a.Qy();a=this.C?$dc(a,this.D):"";b=N(OPd,{mdb:b,VQb:a});this.Lb(b)};p.Za=function(){PPd.oa.Za.call(this);ye(this.getElement(),!0);var a=new mk(this.getElement());this.xa(a);this.getHandler().R(a,"key",this.VYb).R(this.getElement(),"mousedown",this.UYb).R(this.getElement(),"dblclick",this.kob)};
p.VYb=function(a){function b(a,b){for(;b=a(b);)if(yi(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(re,this.getElement());break;case 38:b(Uca,this.getElement())}};p.UYb=function(a){a.preventDefault();this.dispatchEvent("change")};p.kob=function(){this.dispatchEvent("action")};function QPd(a,b,c){M.call(this);this.D=b;this.C=c;RPd(this,a)}x(QPd,M);QPd.prototype.Ma=function(){var a=this.qa().Ma("UL","nfd-pill-container");this.Lb(a)};function RPd(a,b){z(b,function(b){a.Ya(new PPd(b,a.D,a.C),!0)})}QPd.prototype.filter=function(a){a=a.toLowerCase();this.mf(function(b){var c=Kb(Zb(a)),d=b.tb().Qy().toLowerCase();c=c||Tb(d,a);L(b.getElement(),c)})};function U2(a){yq.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.fga();this.Ya(this.input,!0);this.J=new M;this.Ya(this.J,!0);a=this.T5();rb(a,void 0,xNd);this.C=new QPd(a,this.WX(),this.nRa());this.J.Ya(this.C,!0);Oq(this,null);this.Ci=!0}x(U2,yq);p=U2.prototype;p.NTa=Pe;p.nRa=Oe;p.isEmpty=function(){return Kb(this.input.eb())};p.kf=function(){return this.input.tb().kf()};p.Ma=function(){U2.oa.Ma.call(this);var a=be("DIV","dialog-separator");le(a,Cq(this))};
p.Za=function(){U2.oa.Za.call(this);Kh(this.J.getElement(),"nfd-dialog-content");this.getHandler().R(this.C,"change",this.qqb).R(this.C,"action",this.qsa).R(this.input.O,"action",this.qsa).R(this.input,"afterhide",this.Rib);this.input.V&&this.getHandler().R(this.input.V,"input",this.NYb);var a=this.input.Aa;a&&this.getHandler().R(a,"key",this.OYb);a=this.T5()[0];this.input.sM(a)};p.Rib=function(a){a.stopPropagation()};p.qqb=function(a){this.input.sM(a.target.tb());SPd(this.input,!1)};
p.NYb=function(){this.C.filter(this.input.eb());SPd(this.input,!this.input.tb().kf())};p.OYb=function(a){13==a.keyCode&&this.qsa()};p.qsa=function(){this.kf()&&!this.isEmpty()?(B6a.dc(new lP(this.Q1(),void 0,this.NTa())),this.setVisible(!1)):(SPd(this.input,!0),this.input.TBa())};function V2(a){M.call(this);this.J=new M;this.xa(this.J);this.D=new LP("");this.xa(this.D);this.O=new yr("");this.xa(this.O);this.$=a;this.Aa=null}x(V2,M);p=V2.prototype;
p.Za=function(){V2.oa.Za.call(this);var a=Mi(this,"nfd-icwr");this.J.yb(a);this.Ya(this.J);if(a=Mi(this,"nfd-i"))this.D.yb(a),this.D.Od(this.J),Mh(this.D.getElement(),"jfk-textinput"),a=new ps,a.yb(this.D.getElement()),this.xa(a),this.V=a=new os(this.D.getElement()),this.xa(a),this.Aa=a=new mk(this.D.getElement()),this.xa(a),a=new wq(this.D.getElement()),this.getHandler().R(a,"focusout",Ca(this.LTa,!1)).R(a,"focusin",Ca(this.LTa,!0)).R(this.V,"input",this.MYb);a=Mi(this,"nfd-a");this.O.yb(a);this.Ya(this.O)};
p.eb=function(){return this.D.eb()};p.MYb=function(){var a=this.tb(),b=this.eb();W(a.gH,2,b);this.MTa()};p.MTa=Pe;p.LTa=function(a){Oh(this.J.getElement(),"nfd-input-focus",a)};p.sM=function(a){this.Hc(a.clone());this.D.ob(a.Qy());try{this.D.getElement().focus()}catch(b){}};p.TBa=function(){this.D.getElement().focus()};function SPd(a,b){a=a.J.getElement();Oh(a,"nfd-invalid",b)};function TPd(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+Q(a.FZ)+"'>"+UPd(a)+"</div>"+VPd(a,b)+"</div>")}function WPd(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+Q(a.FZ)+"'></div>"+VPd(a,b)+"</div>")}
function XPd(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+Q(a.FZ)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+UPd(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+Q(a.mGb)+"'></div></div></div></div>"+VPd(a,b)+"</div>")}
function YPd(){var a="<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+ZPd({label:""});a+=ZPd({label:qr("Negative:")});a+=ZPd({label:qr("Zero:")});a+=ZPd({label:qr("Text:")});return P(a+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>")}function ZPd(a){return P("<tr><td class='nfd-sample-label'>"+O(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function VPd(a,b){a=""+O(xr({id:a.KV,style:2,Hd:"nfd-apply",content:pr("Apply")},b));return P(a)}function UPd(a){return P(O(YOd({id:a.KJa,i$:a.LJa,UVb:!0})))};function W2(a,b,c,d,e){Kk.call(this,b,c,d,e);this.C=a}x(W2,Kk);W2.prototype.Qj=function(){var a=W2.oa.Qj.call(this),b=this.getParent();return b&&b instanceof Ek&&!b.isVisible()?this.C(a,this.tb()):a};function $Pd(a){V2.call(this,a);this.F=new M;this.C=new qM("")}x($Pd,V2);p=$Pd.prototype;p.Ma=function(){var a=N(XPd,{FZ:Ji(this,"nfd-icwr"),KJa:Ji(this,"nfd-i"),LJa:this.$,mGb:Ji(this,"nfd-ic"),KV:Ji(this,"nfd-a")});this.Lb(a)};p.Za=function(){$Pd.oa.Za.call(this);var a=Mi(this,"nfd-ic");this.F.yb(a);this.F.Od(this.J);this.F.Ya(this.C,!0);this.getHandler().R(this.C,"aftershow",this.PYb).R(this.C,"action",this.FGa).R(this.V,"input",Ca(this.bTa,null))};
p.sM=function(a){$Pd.oa.sM.call(this,a);a.C&&this.D.ob(ht[a.C][1]);this.bTa(a)};
p.bTa=function(a){a=a?a.C:void 0;var b=this.C;b.Gf(null);if(a){var c=this.tb(),d=c.C;aQd(this,c);c=gjc(d,ht[d][2]);c=new lP(bQd(c),fjc[d],d);aQd(this,c);c=gjc(d,d+" "+ht[d][1]);d=new lP(bQd(c),fjc[d],d);aQd(this,d)}else this.tb().C=null;var e="[$"+this.eb()+"]";d=a?fjc[a]:null;c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new lP(bQd(c[e]),d,a);aQd(this,f)}b.Ve(0);this.FGa();Kh(b.Ac().getElement(),"number-format-menu")};function aQd(a,b){var c=new W2(function(a){return cba(a,25)},$dc(b,1E3),b);a.xa(c);a.xa(b);c.jp(!0);a=a.C;for(b=0;b<a.Yh();b++)if(a.Ze(b).Qj()==c.Qj())return;a.Ad(c)}p.FGa=function(){for(var a=this.C,b=0;b<a.Yh();b++)a.Ze(b).zc(!1);a.uD()};p.PYb=function(){this.C.Te().zc(!0)};function bQd(a){var b=new Cv;W(b,2,a);b.setType(4);return b};function cQd(a){U2.call(this,a);zq(this,"Custom currencies")}x(cQd,U2);p=cQd.prototype;p.WX=n(1000.12);p.fga=function(){return new $Pd("Custom currency")};p.T5=function(){var a=this;jgc();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=fjc[e]:qNd(d,ijc(d.ll()))}var f=[];kc(ht,function(b,c){b=hjc(c);a.xa(b);f.push(b)});var h=TKc();wb(f,function(a,b){return h(a.Qy(),b.Qy())});return b.concat(f)};
p.Q1=function(){var a=new Cv;a.setType(4);W(a,3,1);var b=this.input.C.Te().eb().ll();W(a,2,b);return a};p.NTa=function(){return this.input.tb().C};function dQd(a){M.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}x(dQd,M);dQd.prototype.Ma=function(){var a=N(YPd);this.F=Xd("nfd-sample-label",a);this.D=Lca("nfd-rendered-sample",a);this.Lb(a)};function X2(a,b){V2.call(this,a);this.C=new dQd(b);this.Hc(new lP(""))}x(X2,V2);X2.prototype.Ma=function(){var a=N(TPd,{KJa:Ji(this,"nfd-i"),LJa:this.$,FZ:Ji(this,"nfd-icwr"),KV:Ji(this,"nfd-a")});this.Lb(a)};X2.prototype.Za=function(){X2.oa.Za.call(this);this.Ya(this.C,!0);eQd(this)};X2.prototype.MTa=function(){eQd(this)};X2.prototype.sM=function(a){X2.oa.sM.call(this,a);eQd(this)};
function eQd(a){var b=a.tb();if(b){var c=a.C;a=b.ll().split(";").length-1;we(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=$dc(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.ll()),k=d<=a;L(te(e),k);we(e,f);$h(e,"color",h||"")}d=b.kf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.ll()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.ll());c=c.D[3];L(te(c),3<=a);we(c,d);$h(c,"color",b||"")}};function fQd(a){U2.call(this,a);zq(this,"Custom number formats")}x(fQd,U2);fQd.prototype.WX=n(1234.56);fQd.prototype.fga=function(){return new X2("Custom number format",1234.56)};
fQd.prototype.T5=function(){var a=this.F;a.push(new lP("0"));a.push(new lP("0.00"));a.push(new lP("#,##0"));a.push(new lP("#,##0.00"));a.push(new lP("#,##0_);(#,##0)"));a.push(new lP("#,##0_);[Red](#,##0)"));a.push(new lP("#,##0.00_);(#,##0.00)"));a.push(new lP("#,##0.00_);[Red](#,##0.00)"));a.push(new lP("$#,##0_);($#,##0)"));a.push(new lP("$#,##0_);[Red]($#,##0)"));a.push(new lP("$#,##0.00_);($#,##0.00)"));a.push(new lP("$#,##0.00_);[Red]($#,##0.00)"));a.push(new lP("@"));a.push(new lP("0%"));a.push(new lP("0.00%"));
a.push(new lP("0.00E+00"));a.push(new lP("##0.0E+0"));a.push(new lP("# ?/?"));a.push(new lP("# ??/??"));a.push(new lP('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new lP('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new lP('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new lP('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};fQd.prototype.Q1=function(){var a=new Cv;a.setType(2);W(a,3,1);var b=this.input.eb();W(a,2,b);return a};function Y2(a,b){Pk.call(this,b,new gQd(a))}x(Y2,Pk);p=Y2.prototype;p.Wf=function(a,b,c){Y2.oa.Wf.call(this,a,b,c);a.Sb()&&this.Sb()&&a.getParent()==this&&hQd(this)};p.Za=function(){Y2.oa.Za.call(this);hQd(this)};p.Wc=function(a){Y2.oa.Wc.call(this,a);hQd(this)};p.removeChild=function(a,b){a=Y2.oa.removeChild.call(this,a,b);hQd(this);return a};p.Kn=function(a,b){a=Y2.oa.Kn.call(this,a,b);hQd(this);return a};
p.vj=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=Hk(this);if(c){b=39==b;this.we()&&(b=!b);c=c.getElement();c=Sa(c.parentNode.childNodes,c);var d=(d=(d=Hk(this))?ida(d.getElement(),iQd):null)?Sa(d.parentNode.childNodes,d):-1;var e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=jQd(this,e);b?b=jQd(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.eaa(this.Iq()+b);b=!0}else b=!1}b=!b}return b?Y2.oa.vj.call(this,a):!0};
p.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function jQd(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function hQd(a){var b,c=a.Rd(),d=a.ad(),e=nb(Wd("div",iQd,a.getElement())),f=a.getElement();for(b=e.length;b<c.D&&b<d;b++)e[b]=a.qa().Ma("DIV",iQd),f.appendChild(e[b]);f=e.length;c=Array(f);d=[];b=0;for(var h=!1,k=0;k<a.ad();k++)a.Xc(k)instanceof Ok?(d.push(new kQd(b,k,!0)),b=k+1):a.Xc(k)instanceof Jk&&(0==k?h=!0:(a.Xc(k-1),d.push(new kQd(b,k-1,!1)),b=k));k=a.ad();0<d.length&&Ra(d).end!=k-1&&d.push(new kQd(b,k-1,!1));b=h;h=a.ad();if(0==d.length&&b)c[0]=h;else{b=d.length-Math.max(0,d.length-f);b=a.ad()-
b;b=Math.ceil(b/f);if(0==d.length)for(h=0;h<f;h++)c[h]=(h+1)*b-1;else lQd(d,b,f);f=d.length;for(b=0;b<f;b++)c[b]=d[b].end}for(f=d=0;f<a.ad();f++){for(;f>c[d];)++d;b=a.Xc(f);h=b.getElement();h.parentNode!=e[d]&&e[d].appendChild(h);f==c[d]&&b instanceof Ok?L(h,!1):L(h,!0)}for(a=e.length-1;a>d;--a)e[a].parentNode.removeChild(e[a]),e[a]=null}
function lQd(a,b,c){function d(a){return a.end-a.start-(a.fFb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;hb(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,hb(a,l,1))}}function kQd(a,b,c){this.start=a;this.end=b;this.fFb=c}function gQd(a){Nk.call(this);this.D=a}x(gQd,Nk);var iQd="docs-multi-menu-col";function mQd(a){A.call(this);this.C=a}x(mQd,A);mQd.prototype.create=function(){return new Y2(this.C)};function nQd(a,b){V2.call(this,a);this.ma=new M;this.H=new oQd;this.F=new M;a=(new mQd(3)).create();a.Ya(new Jk("Date"),!0);a.Ya(new Kk("Day","DAY_TOKEN"),!0);a.Ya(new Kk("Month","MONTH_TOKEN"),!0);a.Ya(new Kk("Year","YEAR_TOKEN"),!0);a.Ya(new Jk("Time:"),!0);a.Ya(new Kk("Hours","HOURS_TOKEN"),!0);a.Ya(new Kk("Minutes","MINUTES_TOKEN"),!0);a.Ya(new Kk("Seconds","SECONDS_TOKEN"),!0);a.Ya(new Kk("Milliseconds","MILLIS_TOKEN"),!0);a.Ya(new Kk("a.m./p.m.","AM_PM_TOKEN"),!0);a.Ya(new Jk("Duration"),!0);
a.Ya(new Kk("Elapsed hours","ELAPSED_HOURS_TOKEN"),!0);a.Ya(new Kk("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Ya(new Kk("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new CRb(a);this.C=b}x(nQd,V2);p=nQd.prototype;p.Ma=function(){var a=N(WPd,{FZ:Ji(this,"nfd-icwr"),KV:Ji(this,"nfd-a")});this.Lb(a)};
p.Za=function(){nQd.oa.Za.call(this);Kh(this.getElement(),"nfd-date-time-input");var a=Mi(this,"nfd-icwr"),b=this.ma;b.yb(a);b.Od(this);b.Ya(this.L,!0);Kh(this.L.getElement(),"nfd-date-time-menu-button");Kh(this.L.Ac().getElement(),"nfd-date-time-menu");Hh(this.L.qb(),"Add a date or time format");b.Ya(this.H,!0);Oc||Kh(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Ya(a,!0);$h(a.getElement(),"display","inline");this.getHandler().R(this,"cf",Ca(this.OTa,"left")).R(this,"gf",Ca(this.GHa,
"left")).R(this,"hf",Ca(this.GHa,"right")).R(this,"jf",Ca(this.uIa,"left")).R(this,"kf",Ca(this.uIa,"right")).R(this,"ff",Ca(this.OTa,"right")).R(this.L,"action",this.gnb)};p.TBa=function(){this.ma.getElement().focus()};
p.sM=function(a){this.Hc(a.clone());var b=this.F;b.Dd(!0);we(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.ll());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?we(this.H.getElement(),d[2]):(e=b.Xc(b.ad()-1),d=d[2],we(e.Mz.getElement(),Ae(e.Mz.getElement())+d)):pQd(this,e).ob(d[1])}0<b.ad()&&b.Xc(b.ad()-1).Tx.getElement().focus()};
p.eb=function(){for(var a=this.H.toString(),b=0;b<this.F.ad();b++)a+=this.F.Xc(b).toString();a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a);b="";for(var c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=Vb(e,"["),e=Vb(e,"]")):c=!0}b+=e}return b};p.gnb=function(a){a=a.target.eb();pQd(this,a).Tx.getElement().focus()};
function pQd(a,b){SPd(a,!1);switch(b){case "DAY_TOKEN":var c=qQd(a);break;case "MONTH_TOKEN":c=rQd(a);break;case "YEAR_TOKEN":c=sQd(a);break;case "HOURS_TOKEN":c=tQd();break;case "MINUTES_TOKEN":c=uQd();break;case "SECONDS_TOKEN":c=vQd();break;case "MILLIS_TOKEN":c=wQd();break;case "AM_PM_TOKEN":c=xQd(a);break;case "ELAPSED_HOURS_TOKEN":c=yQd();break;case "ELAPSED_MINUTES_TOKEN":c=zQd();break;case "ELAPSED_SECONDS_TOKEN":c=AQd()}b=c;b.Ya(new Ok,!0);b.Ya(new Kk("Delete"),!0);c=new BQd(c,"");a.F.Ya(c,
!0);return c}p.OTa=function(a,b){b=b.target;if(b instanceof oQd){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.Xc(Ni(this.F,b)+1),!b))return}a=Ae(b.Mz.getElement());var c=b.getParent(),d=Ni(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=Ae(b),we(b,c+a),CQd(this.H,c.length)):(d--,b=c.Xc(d),c=Ae(b.Mz.getElement()),we(b.Mz.getElement(),Ae(b.Mz.getElement())+a),CQd(b.Mz,c.length))};
p.uIa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.Xc(Ni(this.F,b)+a))&&a.Tx.getElement().focus()};p.GHa=function(a,b){var c="left"==a?-1:0;(b=this.F.Xc(Ni(this.F,b.target)+c))||"left"!=a?b&&(b=b.Mz):b=this.H;c=Ae(b.getElement()).length;CQd(b,"left"==a?c:0)};function BQd(a,b){M.call(this);this.Tx=new qM("",a);this.Ya(this.Tx,!0);this.Mz=new oQd(b);this.Ya(this.Mz,!0)}x(BQd,M);p=BQd.prototype;
p.Za=function(){BQd.oa.Za.call(this);$h(this.getElement(),"display","inline-block");this.Tx.Ve(0);this.C=new mk(this.Tx.getElement());this.xa(this.C);this.getHandler().R(this.Tx,"action",this.QYb).R(this.C,"key",this.RYb)};p.QYb=function(){this.Tx.uD();this.Tx.Te().tb()||this.dispatchEvent("ff")};p.RYb=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("ff"));break;case 37:a.preventDefault();this.dispatchEvent("gf");break;case 39:a.preventDefault(),this.dispatchEvent("hf")}};
p.toString=function(){return this.Tx.Te().tb()+this.Mz.toString()};p.ob=function(a){this.Tx.ob(a)};function oQd(a){M.call(this);this.C=a||""}x(oQd,M);p=oQd.prototype;p.Ma=function(){var a=be("SPAN");Yd(a,{contentEditable:!0});we(a,this.C);var b=a.style;Kc&&!Uc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=Oc?"-moz-pre-wrap":"pre-wrap";this.Lb(a)};
p.Za=function(){oQd.oa.Za.call(this);var a=new mk(this.getElement());this.xa(a);this.getHandler().R(a,"key",this.SYb).R(this.getElement(),"paste",this.TYb)};function CQd(a,b){if(0==Ae(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=HK(c,b);a.getElement().focus();b.select()}}
p.SYb=function(a){var b=ze(this.getElement()),c=xK(),d=Ae(this.getElement()).length,e=c?0==c.wh()&&0==c.xn():Kb(Zb(b));b=c?c.wh()==d&&c.xn()==d:Kb(Zb(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("cf"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("ff"));break;case 40:this.dispatchEvent("df");break;case 38:this.dispatchEvent("ef");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("jf"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("kf"));break;
case 13:a.preventDefault()}};p.toString=function(){var a=Mb(Ae(this.getElement())).replace(/"/g,'"\\""');return 0==Zb(a).length?"":'"'+a+'"'};p.TYb=function(){var a=v(function(){we(this.getElement(),Ae(this.getElement()))},this);Wi(a)};
function qQd(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Day without leading zero ("+(e+")");c.push(new W2(Ca(b,e),f,d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day with leading zero ("+(e+")");c.push(new W2(Ca(b,e),f,d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day as abbreviation ("+(e+")");c.push(new W2(Ca(b,e),f,d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Day as full name ("+
(e+")");c.push(new W2(Ca(b,e),a,d));d=new Pk;for(e=0;e<c.length;e++)d.Ya(c[e],!0);return d}
function rQd(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Month without leading zero ("+(e+")");c.push(new W2(Ca(b,e),f,d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month with leading zero ("+(e+")");c.push(new W2(Ca(b,e),f,d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month as abbreviation ("+(e+")");c.push(new W2(Ca(b,e),f,d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,
d);f="Month as full name ("+(e+")");c.push(new W2(Ca(b,e),f,d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="First letter of the month ("+(e+")");c.push(new W2(Ca(b,e),a,d));d=new Pk;for(e=0;e<c.length;e++)d.Ya(c[e],!0);return d}
function sQd(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Two-digit year ("+(e+")");c.push(new W2(Ca(b,e),f,d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Full numeric year ("+(e+")");c.push(new W2(Ca(b,e),a,d));d=new Pk;for(e=0;e<c.length;e++)d.Ya(c[e],!0);return d}
function tQd(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new W2(Ca(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new W2(Ca(a,d),e,c));c=new Pk;for(d=0;d<b.length;d++)c.Ya(b[d],!0);return c}
function uQd(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new W2(Ca(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new W2(Ca(a,d),e,c));c=new Pk;for(d=0;d<b.length;d++)c.Ya(b[d],!0);return c}
function vQd(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new W2(Ca(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new W2(Ca(a,d),e,c));c=new Pk;for(d=0;d<b.length;d++)c.Ya(b[d],!0);return c}
function wQd(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new W2(Ca(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new W2(Ca(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new W2(Ca(a,d),e,c));c=new Pk;for(d=0;d<b.length;d++)c.Ya(b[d],!0);return c}
function xQd(a){function b(a){return"a.m./p.m. ("+(a+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Full ("+(e+")");c.push(new W2(Ca(b,e),f,d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Shortened lowercase ("+(e+")");c.push(new W2(Ca(b,e),f,d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Shortened uppercase ("+(e+")");c.push(new W2(Ca(b,e),a,d));d=new Pk;for(e=0;e<c.length;e++)d.Ya(c[e],!0);return d}
function yQd(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new W2(Ca(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new W2(Ca(a,d),e,c));c=new Pk;for(d=0;d<b.length;d++)c.Ya(b[d],!0);return c}
function zQd(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new W2(Ca(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new W2(Ca(a,d),e,c));c=new Pk;for(d=0;d<b.length;d++)c.Ya(b[d],!0);return c}
function AQd(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new W2(Ca(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new W2(Ca(a,d),e,c));c=new Pk;for(d=0;d<b.length;d++)c.Ya(b[d],!0);return c};function DQd(a){U2.call(this,a);zq(this,"Custom date and time formats")}x(DQd,U2);p=DQd.prototype;p.nRa=Ne;p.WX=n(11175.5628472222);p.isEmpty=function(){return Kb(uv(this.Q1(),2))};p.kf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(uv(this.Q1(),2))};p.fga=function(){return new nQd("Custom date time format",11175.5628472222)};p.Q1=function(){return EQd(this.input.eb())};
p.T5=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.WX(),c.ll());c.D=d}b=FQd(this);rb(b);for(c=0;c<b.length;c++)a.push(new lP(EQd(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.WX(),b[c])));return a};
function FQd(a){var b=Ys,c=Va(b.DATEFORMATS,function(a){return GQd(a)},a),d=Va(b.TIMEFORMATS,function(a){return GQd(a)},a),e=c.concat(d);b=b.DATETIMEFORMATS;rb(b);a=Va(b,function(a){return GQd(a)},a);for(b=0;b<a.length;b++){var f=a[b];f=f.replace(/\{1\}/,c[0]);f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function GQd(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Nb(a.join(""))}function EQd(a){var b=new Cv;b.setType(7);W(b,3,1);W(b,2,a);return b};function HQd(a,b){this.D=a;this.C=b}HQd.prototype.getUrl=g("D");HQd.prototype.getTitle=g("C");function IQd(a,b,c,d,e,f){ks.call(this,a,b,"domain",d,e,f);this.H=c}x(IQd,ks);IQd.prototype.vV=function(){var a=IQd.oa.vV.call(this);a.domainName=this.H;return lc(a,NFa)};fGa.set("domain",function(a){return new IQd(a.name,a.id,a.domainName,a.me,a.iconUrl,a.requiresKey)});new IQd("","DEFAULT","",!0);function JQd(){};function KQd(a){for(var b="",c=a.kSb,d=c.length,e=0;e<d;e++){var f=c[e],h=a.iSb[f.yh()],k=f.getLabel();f=f.VFb;f=P('<div id="'+Q(h)+'" tabindex="0" role="link" class="'+Q("ess-button")+'" aria-label="'+Q(k)+'"><div class="'+Q("ess-icon")+" "+Q(f)+'"></div></div>');b+=f}return P(b)};function LQd(a,b){M.call(this,b);this.D=a||[];this.F=[];this.C=null}x(LQd,M);p=LQd.prototype;p.Ud=!0;p.yea=!1;p.qP=null;p.gAa=!1;p.mb=function(a,b){this.Ud=a;this.yea=b;if(this.gAa){b=this.qa();for(var c=0,d;d=this.D[c];c++){var e=b.getElement(this.qP.jqa+"-"+d.yh()),f=a;Oh(e,"ess-button",f);Oh(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();pj(e,f,d)}}};
p.Ma=function(){this.Lb(this.Bb.createElement("SPAN"));var a={};a.jqa=Ji(this,"service");a.kSb=this.D;this.qP=a;for(var b={},c=0,d;d=this.D[c];c++)b[d.yh()]=this.qP.jqa+"-"+d.yh();a.iSb=b;this.qP=a;hr(this.getElement(),KQd,this.qP);this.gAa=!0};
p.eQb=function(a){if(this.Ud){if(this.C){var b={};b.externalSharingService=a.C;this.C.C(9,b)}if(this.yea)this.dispatchEvent(new MQd(new NQd(a,this.F,this.C||void 0)));else{var c=this.C||void 0;b=a.getUrl(this.F);if(c){var d={};d.externalSharingService=a.C;c.C(10,d)}a={gGc:!0};a.target=a.target||b.target||"google_popup";a.width=a.width||690;a.height=a.height||500;(a=Kp(b,a))&&a.focus()}}};
p.Za=function(){this.mb(this.Ud,this.yea);for(var a=this.qa(),b=this.getHandler(),c=0,d;d=this.D[c];c++){var e=a.getElement(this.qP.jqa+"-"+d.yh());b.vg(e,mf,v(this.eQb,this,d))}};p.Xa=function(){LQd.oa.Xa.call(this);delete this.F;delete this.D;this.C=null};function MQd(a,b){D.call(this,"lf",b);this.context=a}x(MQd,D);function NQd(){}x(NQd,JQd);function Z2(a,b,c,d){this.C=a;this.F=b;this.D=c;this.VFb=d;this.H=OQd++}var OQd=0;Z2.prototype.yh=g("H");Z2.prototype.getName=g("F");Z2.prototype.getLabel=g("D");function PQd(){Z2.call(this,"fb","Facebook","Share via Facebook","ess-facebook-icon")}x(PQd,Z2);PQd.prototype.getUrl=function(a){var b=Va(a,function(a){return a.getTitle()});a=Va(a,function(a){return a.getUrl()});return"http://www.facebook.com/share.php?u="+Ob(a.join(","))+"&t="+Ob(b.join(","))};function QQd(){Z2.call(this,"gp","Google+","Share via Google+","ess-gplus-icon")}x(QQd,Z2);QQd.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Ob(a[0].getUrl())};function RQd(){Z2.call(this,"gm","Gmail","Share via Gmail","ess-gmail-icon")}x(RQd,Z2);RQd.prototype.getUrl=function(a){a=Va(a,function(a){return a.getTitle()+" - "+a.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Ob(a.join("\n"))};function SQd(){Z2.call(this,"tw","Twitter","Share via Twitter","ess-twitter-icon")}x(SQd,Z2);SQd.prototype.getUrl=function(a){for(var b=oa(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){f=a[e].getTitle();h=c[e]?" - ":"";var k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Ob(a)};function $2(a){M.call(this,a)}x($2,M);function TQd(a){a.dispatchEvent(new D("mf"))}$2.prototype.ZX=function(){return{}};$2.prototype.mK=Pe;$2.prototype.dqa=sa;function UQd(a){M.call(this,a)}x(UQd,M);UQd.prototype.F=Pe;UQd.prototype.H=sa;UQd.prototype.J=sa;function VQd(a,b,c){b=c||b;c='<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">';var d="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+wNd(a.locale)+'&answer=183965">Learn more</a>');c=c+d+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link';
c+='</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">';c+="Embed";c+='</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+Q(a.w8a)+'" readonly="readonly" aria-label="';c+=tr("Link to published document.");c+=" "+Q(a.MOa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">';
c+="Or share this link using:";c+='</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="';c+=tr("HTML embed code of published document.");c+=" "+Q(a.MOa)+'">'+ZDa(a.pcb)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+O(xr({id:"pub-dialog-publish-link-button",
style:2,value:a.dQb},b))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+O(qs({rt:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"},b));c+="Published content and settings";c+='</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+O(xr({id:"pub-dialog-publish-button",value:a.bQb},b))+'<div class="pub-dialog-checkbox-container">';
a.yGb&&(c+=O(Et({id:"pub-dialog-dom-signin-req",checked:a.Ls,disabled:a.EJ},b))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.EJ?' class="pub-dialog-disabled-text"':"")+">",d="Require viewers to sign in with their "+(O(a.domain)+" account"),c+=d,c+="</label><br>");a.wP&&(c+=O(Et({id:"pub-dialog-auto-publish-checkbox"},b))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">',c+="Automatically republish when changes are made",
c+="</label>");c+="</div></div></div></div></div>";return P(c)};function a3(a,b,c,d,e,f,h,k,l,m){At.call(this);this.Cb=a||"";this.Fe=b;this.fd=c;this.Yc=d;this.Gc=l||"/publishsettings";this.C=new WQd(e);this.Jb=new LQd([new QQd,new RQd,new PQd,new SQd]);this.Ya(this.Jb);this.Aa=new yr(null,this.qa());this.Ya(this.Aa);this.ma=new yr(null,this.qa());this.Ya(this.ma);this.sb=new Ft(void 0,this.qa());this.Ya(this.sb);this.Ra=new Ft(void 0,this.qa());this.Ya(this.Ra);this.ub=0;this.Qb=new XQd;this.Ya(this.Qb);this.Gb=this.Kb=null;this.J=f||new $2;this.Ya(this.J);this.F=
h||new $2;this.Ya(this.F);this.rb=k||new UQd;this.Ya(this.rb);this.O=this.L=null;this.ib=new is(void 0,YQd,this.qa(),2);this.xa(this.ib);this.Be=this.yd=null;this.Pe=m||new M;this.Wb=this.zb=this.Nb=null;this.Ci=!0}x(a3,At);var YQd="Press "+((Rc?"\u2318+C":"Ctrl+C")+" to copy.");p=a3.prototype;p.od=function(){a3.oa.od.call(this);this.ib.od()};p.show=function(){ZQd(this,v(function(){this.setVisible(!0)},this))};
p.setVisible=function(a){a3.oa.setVisible.call(this,a);var b=He(this.qa());a?this.getHandler().R(b,"resize",this.od):this.getHandler().Kc(b,"resize",this.od)};
p.Ma=function(){a3.oa.Ma.call(this);var a=this.qa(),b=N(VQd,{yGb:!!this.C.domain,wP:this.C.wP(),Ls:this.C.Ls,domain:this.C.C,EJ:this.C.EJ,bQb:$Qd(this),dQb:b3(this,aRd(this))?"Published":"Publish",w8a:this.C.Bk?bRd(this,this.J.ZX()):"",pcb:this.C.Bk?cRd(this,this.F.ZX()):"",locale:"en-GB",MOa:YQd});a.appendChild(this.Ob(),b);zq(this,"Publish to the web");Oq(this,null);Kh(this.Ob(),"pub-dialog-content")};
p.Za=function(){var a=this.qa(),b=a.getElement("pub-dialog-sharing-services-links");this.Jb.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.Nb=a.getElement("pub-dialog-links-notice");this.Pe.render(this.Nb);b=a.getElement("pub-dialog-published-content");this.rb.render(b);a3.oa.Za.call(this);b=this.getHandler();var c=a.getElement("pub-dialog-dom-signin-req");c&&(this.sb.yb(c),Dt(this.sb,a.getElement("pub-dialog-dom-signin-req-label")),
b.R(this.sb,"change",this.eVb));this.C.wP()&&(this.Ra.yb(a.getElement("pub-dialog-auto-publish-checkbox")),Dt(this.Ra,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.R(this.Ra,"change",this.aVb));this.Kb=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.Gb=a.getElement("pub-dialog-embed-tab-content");this.O=a.getElement("pub-dialog-embed-code");es(this.ib,this.L);this.Qb.yb(a.getElement("pub-dialog-links-tab-bar"));this.yd=a.getElement("pub-dialog-sharing-services");
this.Be=a.getElement("pub-dialog-status-info");this.Aa.yb(a.getElement("pub-dialog-publish-link-button"));this.ma.yb(a.getElement("pub-dialog-publish-button"));this.Wb=new UN("pub-dialog-settings-header","pub-dialog-settings-content",this.C.Bk);this.xa(this.Wb);b.R(this.Qb,"select",this.hAb).R(this.L,"focus",this.iQa).R(this.O,"focus",this.iQa).R(this.ma,"action",this.fQb).R(this.getElement(),"keyup",this.K7a).R(this.J,"mf",this.Ora).R(this.F,"mf",this.Ora).R(this.Aa,"action",this.hyb).R(this.rb,
"nf",this.iyb).R(this.Wb,"toggle",this.od);dRd(this)};function dRd(a){if(a.Sb()){var b=a.qa(),c=a.C.Bk,d=a.C.EJ;a.rb.H(a.C.Cm);a.sb.mb(!d);a.ma.setContent($Qd(a));a.ma.mb(a.C.Bk||!a.C.Cm||!a.C.Cm.isEmpty());a.C.wP()&&a.Ra.zc(a.C.gw);a.Ora();b=b.xi("pub-dialog-state-publishing");z(b,function(a){L(a,c)});we(a.Be,c?"This document is published to the web.":"This document is not published to the web.");a.od()}}p.K7a=function(a){this.isVisible()&&27==a.keyCode&&a.stopPropagation()};
function eRd(a,b){var c=window.location.href,d=jl(c);c=ml(c);var e=Tb(c,"/"+a.Yc+"/")?"/"+a.Yc:"";a.C.Ls&&a.C.domain&&(e="/a/"+a.C.domain+e);c=d[1];var f=d[2],h=d[3];d=d[4];a=a.C.F||a.Cb;b=wKa.test(b)?b:Bl("/d/"+a,b);return il(c,f,h,d,Bl(e,b))}
p.Ora=function(){var a=this.J.mK();if(a=b3(this,a)){var b=this.C.Bk?bRd(this,this.J.ZX()):"";this.L.value=b;this.Jb.F=[new HQd(b,this.Fe)]}L(this.L,a);L(this.yd,a&&!this.C.EJ);a=this.F.mK();if(a=b3(this,a))this.O.value=this.C.Bk?cRd(this,this.F.ZX()):"";L(this.O,a);a=b3(this,aRd(this));L(this.Nb,a);this.Aa.mb(!a);this.Aa.setContent(b3(this,aRd(this))?"Published":"Publish")};
p.hAb=function(a){a=a.target;this.qa();SFa(this.ib);"pub-dialog-link-tab"==a.getId()?(this.ub=0,L(this.Kb,!0),L(this.Gb,!1),es(this.ib,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.ub=1,L(this.Kb,!1),L(this.Gb,!0),es(this.ib,this.O));dRd(this)};p.iQa=function(a){Wi(function(){a.target.select()},0)};p.eVb=function(){this.C.Bk?fRd(this,2,!1):this.C.Ls=!this.C.Ls};p.aVb=function(){this.C.Bk?fRd(this,0,!1):this.C.gw=!this.C.gw};function $Qd(a){return a.C.Bk?"Stop publishing":"Start publishing"}
function ZQd(a,b){Cs($m(a.fd.ef(a.Gc),"id",a.Cb),v(function(a){this.C.Bk=!!dn(a,"published");this.C.Ls=!!dn(a,"requireSignin");this.C.EJ=!!dn(a,"domainClosed");this.C.domain=vzc(a,"domain");this.C.C=vzc(a,"domainDisplay");this.C.gw=!Number(dn(a,"revision"));this.C.Cm=this.xDa(a.nf());this.C.F=vzc(a,"publishedDocumentId");b()},a)).Ge()}p.xDa=Pe;p.cDa=Pe;function gRd(a){return{gw:a.C.gw,Bk:a.C.Bk,Ls:a.C.Ls,Cm:a.C.Cm}}
function fRd(a,b,c){c=t(c)?c:!0;var d=gRd(a);switch(b){case 0:d.gw=!d.gw;break;case 1:d.Bk=!d.Bk;break;case 2:d.Ls=!d.Ls;break;default:throw Error("Unknown toggle op: "+b);}d.Bk||(d.Cm=a.cDa());hRd(a,d,c)}
function hRd(a,b,c){iRd(a,!1);lu(Cs(Zm(Ht($m(a.fd.ef(a.Gc),"id",a.Cb),jRd(a,b)),2),v(function(){this.C.gw=b.gw;this.C.Bk=b.Bk;this.C.Ls=b.Ls;this.C.Cm=b.Cm;this.C.Bk&&this.C.Cm&&(b3(this,this.J.mK())||this.J.dqa(this.C.Cm),b3(this,this.F.mK())||this.F.dqa(this.C.Cm));iRd(this,!0);dRd(this);if(c&&this.C.Bk)switch(this.ub){case 0:this.L.focus();this.L.select();break;case 1:this.O.focus();this.O.select();break;default:throw Error("Cannot handle selected link type "+this.ub);}},a)),v(function(){wLa("An error occurred whilst saving publishing settings.",
void 0,this.Sb()?this:void 0);iRd(this,!0);dRd(this)},a)).Ge()}function jRd(a,b){var c={id:a.Cb,requireSignin:b.Ls,published:b.Bk};a.C.wP()&&!b.gw&&(c.revision=a.C.D);b.Cm&&(a=kRd(b.Cm),Ec(c,a));return c}function iRd(a,b){for(var c=[a.Ra,a.ma,a.Aa,a.sb],d=0;d<c.length;d++){var e=c[d];!b&&e.Do()&&(a.zb=e);e.mb(b)}b&&a.zb&&(a.isVisible()&&a.zb.isVisible()&&(c=a.zb.getElement())&&c.focus(),a.zb=null);a.rb.J(b)}
p.fQb=function(a,b){if(b||window.confirm(this.C.Bk?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.ma.setContent("Saving..."),fRd(this,1)};function aRd(a){switch(a.ub){case 0:return a.J.mK();case 1:return a.F.mK();default:throw Error("Cannot handle selected link type "+a.ub);}}
p.hyb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=aRd(this),b=gRd(this);b.Bk=!0;a&&(b.Cm&&this.C.Bk?b.Cm=lRd(b.Cm,a):b.Cm=a);this.Aa.setContent("Publishing...");hRd(this,b,!0)}};p.iyb=function(){var a=this.rb.F();if(this.C.Bk)if(a&&a.isEmpty())fRd(this,1);else{var b=gRd(this);b.Cm=a;hRd(this,b)}else this.C.Cm=a,dRd(this)};function b3(a,b){var c;(c=a.C.Bk)&&!(c=!b||!a.C.Cm)&&(a=a.C.Cm,c=a.F||!b.F&&$a(b.D.xd(),a.K8,a)&&$a(b.C,a.y8,a));return c}
function WQd(a){this.D=a;this.EJ=this.Ls=this.Bk=!1;this.gw=!0;this.F=this.C=this.domain=""}WQd.prototype.wP=function(){return!!this.D};function XQd(){HS.call(this)}x(XQd,HS);XQd.prototype.vj=function(a){return a.keyCode&&27==a.keyCode?!1:XQd.oa.vj.call(this,a)};function mRd(a,b,c,d){this.F=a;this.uh=b;this.C=c;this.D=d}function nRd(a,b){return new mRd(!1,null,new oRd(a,b||"interactive"),null)}function oRd(a,b){this.id=a;this.format=b};function c3(a,b,c){this.F=a;this.D=new Um(b);this.C=c}p=c3.prototype;p.K8=function(a){return this.F||this.D.contains(a)};function pRd(a,b){return Ya(a.C,function(a){return a.id==b.id})}p.y8=function(a){return this.F||this.D.contains(a.uh)||pRd(this,a)};function qRd(a,b){a.C=Ua(a.C,function(a){return a.uh!=b})}function rRd(a,b){pRd(a,b)&&(a.C=Ua(a.C,function(a){return a.id!=b.id}))}
function lRd(a,b){var c=a.F||b.F;if(c)return new c3(c,[],[]);var d=a.clone();z(b.D.xd(),function(a){d.D.contains(a)||(d.D.add(a),qRd(d,a))});z(b.C,function(a){d.y8(a)||d.C.push(a)});return d}function kRd(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.xd().join(","),charts:Va(a.C,function(a){return a.id}).join(",")}}p.isEmpty=function(){return!this.F&&this.D.isEmpty()&&db(this.C)};p.clone=function(){return new c3(this.F,this.D.xd(),nb(this.C))};
p.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&yb(this.C,a.C,function(a,c){return a.id==c.id&&a.uh==c.uh})};function sRd(a,b){this.id=a;this.uh=b};function tRd(a,b,c,d){M.call(this,void 0);this.C=c||new mRd(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new qM("",uRd(a,b));bP(this.D,!0);this.Ya(this.D,!0);a=new Pk;a.Ya(new Kk("Interactive","interactive"),!0);a.Ya(new Kk("Image","image"),!0);this.H=new qM("",a);this.Ya(this.H,!0);a=new Pk;a.Ya(new Kk("Web page","html"),!0);a.Ya(new Kk("Comma-separated values (.csv)","csv"),!0);a.Ya(new Kk("Tab-separated values (.tsv)","tsv"),!0);a.Ya(new Kk("PDF document (.pdf)","pdf"),!0);a.Ya(new Kk("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Ya(new Kk("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new qM("",a);this.Ya(this.F,!0);vRd(this)}x(tRd,$2);var wRd=["xlsx","ods"],xRd=["csv","tsv"];
function uRd(a,b){var c=new Pk;c.Ya(new Kk("Entire Document",new yRd("entireDocument",null)),!0);c.Ya(new Ok,!0);var d=ztb(b);z(a.D,function(a){c.Ya(new Kk(a.Wd(),new yRd("sheet",a.Ib())),!0);if(a=d[a.Ib()])for(var b={},e=0;e<a.length;b={WV:b.WV},e++){var k=a[e];6==k.getType()&&k.isSaved()&&(b.WV=new Kk("",new yRd("chart",RH(k))),aI(k).then(function(a){return function(b){a.WV.Dm(b.getTitle())}}(b)),c.Ya(b.WV,!0),Kh(b.WV.Ob(),"pub-dialog-link-options-chart-menu-item"))}});return c}p=tRd.prototype;
p.Za=function(){tRd.oa.Za.call(this);Kh(this.getElement(),"pub-dialog-link-options-container");Kh(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");Kh(this.D.Ob(),"pub-dialog-link-options-document-part-menu-button-content");Kh(this.D.Ac().getElement(),"pub-dialog-link-options-document-part-menu");Hh(this.D.qb(),"Sheet or chart selection");Hh(this.H.qb(),"Chart format");Hh(this.F.qb(),"Sheet format");this.getHandler().R(this.D,"change",this.dob).R(this.H,"change",this.Wkb).R(this.F,
"change",this.TAb).R(this.D,"afterhide",function(a){a.stopPropagation()}).R(this.H,"afterhide",function(a){a.stopPropagation()}).R(this.F,"afterhide",function(a){a.stopPropagation()})};p.dob=function(){var a=this.D.Te().tb();switch(a.type){case "entireDocument":this.C=new mRd(!0,null,null,this.C.D||"html");break;case "sheet":a=a.id;var b=this.C.D;b&&!zRd(this,a,b)&&(b=null);this.C=new mRd(!1,a,null,b||"html");break;case "chart":this.C=nRd(a.id,this.C.C?this.C.C.format:null)}vRd(this);TQd(this)};
p.Wkb=function(){var a=this.H.Te().tb();this.C.C&&(this.C.C.format=a,TQd(this))};p.TAb=function(){var a=this.F.Te().tb();this.C.D=a;TQd(this)};
function vRd(a){var b=nb(a.D.mj.C);b=ab(b,function(a){a=a.tb();if(!a)return!1;switch(a.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.uh&&a.id==this.C.uh;case "chart":return null!=this.C.C&&a.id==this.C.C.id;default:return!1}},a);Nr(a.D,b);b=!!a.C.C;L(a.H.getElement(),b);null!=a.C.C&&a.H.ob(a.C.C.format);L(a.F.getElement(),a.J&&!b);b||(ARd(a),a.F.ob(a.C.D))}
function ARd(a){for(var b=a.F.Ac(),c=0;c<b.Yh();c++){var d=b.Ze(c),e=d.eb();d.mb(null==a.C.uh||zRd(a,a.C.uh,e))}}function zRd(a,b,c){if(cb(wRd,c))return!1;a=vA(a.O,b);return null!=a&&1==a.getSheetType()&&cb(xRd,c)?!1:!0}p.ZX=g("C");p.mK=function(){if(this.C.F)return new c3(!0,[],[]);if(null!=this.C.uh)return new c3(!1,[this.C.uh],[]);var a=this.L.C(this.C.C.id);a=new sRd(this.C.C.id,a.Ib());return new c3(!1,[],[a])};
p.dqa=function(a){if(!a.F){var b=a.D.xd();0<b.length?this.C=new mRd(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=nRd(a[0].id)));vRd(this)}};function yRd(a,b){this.type=a;this.id=b};function d3(a,b){Cr.call(this,void 0,void 0,new pM,void 0);this.Ra=a;this.ma=b;this.F=new c3(!0,[],[]);this.V=!1;this.H=new SN("Entire Document");this.Ad(this.H);this.Ad(new Ok);BRd(this);bP(this,!0);CRd(this)}x(d3,Cr);function BRd(a){var b=ztb(a.ma);z(a.Ra.D,function(c){var d=new SN(c.Wd(),c);a.Ad(d);(c=b[c.Ib()])&&z(c,function(b){if(6==b.getType()&&b.isSaved()){var c=new SN("",b);aI(b).then(function(a){c.Dm(a.getTitle())});a.Ad(c);Kh(c.Ob(),"pub-dialog-published-content-chart-menu-item")}})})}
d3.prototype.Za=function(){d3.oa.Za.call(this);Kh(this.getElement(),"pub-dialog-published-content-menu-button");Kh(this.Ob(),"pub-dialog-published-content-menu-button-content");Kh(this.Ac().getElement(),"pub-dialog-published-content-menu");this.getHandler().R(this,"afterhide",function(a){a.stopPropagation()})};
d3.prototype.us=function(a){if(a.target==this.H){a=this.H.isChecked();var b=this.F;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.tb(),b instanceof wA?(b=b.Ib(),a?(a=this.F,a.D.contains(b)||(a.D.add(b),qRd(a,b))):(a=this.F,a.D.contains(b)&&(a.D.remove(b),qRd(a,b)))):(b=new sRd(RH(b),b.Ib()),a?(a=this.F,a.y8(b)||a.C.push(b)):rRd(this.F,b));this.V=!0;CRd(this)};d3.prototype.Md=function(a,b){d3.oa.Md.call(this,a,b);!a&&this.V&&(this.V=!1,this.dispatchEvent(new D("nf")))};
function CRd(a){var b=a.F.F;a.H.zc(b);z(uzc(a.Ac()),function(c){var d=c.tb();d&&(d instanceof wA?(c.zc(a.F.K8(d.Ib())),c.mb(!b)):(d=new sRd(RH(d),d.Ib()),c.zc(a.F.y8(d)),c.mb(!a.F.K8(d.uh))))});DRd(a)}
function DRd(a){if(a.F.F)a.setContent("Entire Document");else{var b=Ua(a.Ra.D,v(function(a){return this.F.K8(a.Ib())},a)),c=Va(b,function(a){return a.Wd()});b=[];for(var d=a.F.C,e=0;e<d.length;e++){var f=a.ma.C(d[e].id);f&&b.push(aI(f))}Pea(b).then(function(b){for(var d=[],e=0;e<b.length;e++){var f=b[e];f.eCa&&d.push(f.value.getTitle())}b=mb(c,d);b=0<b.length?b.join(", "):"None";a.setContent(b)})}};function e3(a,b){M.call(this,void 0);this.C=new d3(a,b);this.Ya(this.C,!0);this.D=!1}x(e3,UQd);e3.prototype.Za=function(){e3.oa.Za.call(this);Kh(this.getElement(),"pub-dialog-published-content-container")};e3.prototype.F=function(){return this.C.F};e3.prototype.H=function(a){var b=this.C;b.F=a.clone();CRd(b)};e3.prototype.J=function(a){!a&&this.C.Do()&&(this.D=!0);this.C.mb(a);a&&this.D&&(this.Sb()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function ERd(a){var b='<div class="pub-dialog-chart-notice">';a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+wNd(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return P(b+a+"</div>")};function FRd(a,b,c,d,e,f,h){var k=null!=h?nRd(h):null;h=new tRd(c,d,k,!0);k=new tRd(c,d,k,!1);a3.call(this,a,b,e,B3a,f,h,k,new e3(c,d),"/publishingsettings",new GRd);this.jf=c;this.mc=d}x(FRd,a3);
FRd.prototype.xDa=function(a){if(a.entireDocument)return new c3(!0,[],[]);var b=a.charts||"";a=Va((a.sheets||"").split(","),function(a){return parseInt(a,10)});a=Ua(a,function(a){return null!=vA(this.jf,a)},this);b=Va(b.split(","),function(a){return parseInt(a,10)});b=Ua(b,v(function(a){return!!this.mc.C(a)},this));b=Va(b,function(a){var b=this.mc.C(a);return new sRd(a,b.Ib())},this);return new c3(!1,a,b)};FRd.prototype.cDa=function(){return new c3(!0,[],[])};
function bRd(a,b){if(b.F||null!=b.uh){var c="html"==b.D;a=eRd(a,c?"/pubhtml":"/pub");null!=b.uh&&(a=ul(a,"gid",b.uh,"single","true"));c||(a=ul(a,"output",b.D))}else a=ul(eRd(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function cRd(a,b){var c=bRd(a,b);if(b.F||null!=b.uh)c=ul(c,"widget","true","headers","false");a=b.C?(a=a.mc.C(b.C.id))?a.Zc():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Qb(c)+'"></iframe>'}function GRd(){}x(GRd,M);GRd.prototype.Ma=function(){this.Lb(N(ERd,{locale:"en-GB"}))};function HRd(){A.call(this)}x(HRd,Zz);p=HRd.prototype;p.xdb=function(){return CNd};p.Qdb=function(){return ENd};p.vKb=function(a,b,c,d){var e=new ps;a=new Xq(a,b,c,d,void 0,!0,void 0);br(a,"ok");b=v(e.yb,e);a.vma=b;a.xa(e);a.Ci=!0;a.N6=wda(Kb);return a};p.yfb=function(){return bPd};p.V4a=function(a,b,c,d,e,f,h){return new IPd(a,b,c,d,e,f,h,void 0)};p.$db=function(){return kOd};p.TCa=function(){return AOd};p.qeb=function(){return KOd};p.Dfb=function(){return T2};p.Cfb=function(){return FRd};
p.jfb=function(){return SOd};p.Bfb=function(){return iPd};p.Udb=function(){return fQd};p.zfb=function(){return cQd};p.Afb=function(){return DQd};p.Tdb=function(){return I2};p.keb=function(){return zNd};p.igb=function(){return ANd};eA("dialogs",HRd);
